---
### DO NOT EDIT! Generated by script/update-book2.rb
category: book
section: documentation
subsection: book
sidebar: book
book:
  language_code: sr
  chapter:
    title: Гит алати
    number: 7
  section:
    title: Подмодули
    number: 11
    cs_number: '7.11'
    previous: book/sr/v2/Гит-алати-Отклањање-грешака-са-програмом-Git
    next: book/sr/v2/Гит-алати-Паковање
title: Git - Подмодули
url: "/book/sr/v2/Гит-алати-Подмодули.html"
---
<h2 id="_git_submodules">Подмодули</h2>
<div class="paragraph">
<p>Док радите на једном пројекту, често имате потребу да унутар њега користите неки други пројекат.
Можда је то библиотека коју је развио неко други или коју ви развијате одвојено користећи више родитељских пројеката.
У овим случајевима долази до заједничког проблема: желите имати могућност да два пројекта третирате као одвојене, а да у исто време један од њих можете користити из другог.</p>
</div>
<div class="paragraph">
<p>Ево примера.
Претпоставимо да развијате веб сајт и креирате Атом вести.
Уместо да пишете свој сопствени кôд који генерише Атом, одлучујете да употребите библиотеку.
Највероватније ћете морати или да укључите тај кôд из дељене библиотеке као што је CPAN <em>install</em> или Руби <em>gem,</em> или да у своје стабло пројекта копирате тај изворни кôд.
Проблем са додавањем библиотеке преставља тешкоћа у прилагођавању библиотеке на било који начин, а често је још теже и да се библиотека достави јер морате обезбедити да библиотека буде доступна сваком клијенту.
Проблем са копирањем кода у ваш пројекат је у компликованом спајању ваших локалних промена кода библиотеке са новим узводним променама.</p>
</div>
<div class="paragraph">
<p>Програм Гит решава овај проблем употребом подмодула.
Подмодули вам омогућавају да Гит репозиторијум чувате као поддиректоријум неког другог Гит репозиторијума.
На тај начин можете да клонирате други репозиторијум у свој пројекат и да ваше комитове држите раздвојене.</p>
</div>
<div class="sect3">
<h3 id="_starting_submodules">Први кораци са подмодулима</h3>
<div class="paragraph">
<p>Проћи ћемо кроз развој једноставног пројекта који је подељен на неколико потпројеката.</p>
</div>
<div class="paragraph">
<p>Хајде да почнемо тако што је ћемо постојећи Гит репозиторијум додати као подмодул репозиторијума у којем радимо.
Да бисте додали нови подмодул, користите <code>git submodule add</code> команду са апсолутном или релативном URL адресом пројекта који желите почети да пратите.
У овом примеру ћемо додати библиотеку под називом „DbConnector”.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git submodule add https://github.com/chaconinc/DbConnector
Cloning into 'DbConnector'...
remote: Counting objects: 11, done.
remote: Compressing objects: 100% (10/10), done.
remote: Total 11 (delta 0), reused 11 (delta 0)
Unpacking objects: 100% (11/11), done.
Checking connectivity... done.</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Submodules</em> ће подразумевано додати потпројекат у директоријум са истим именом као и репозиторијум, у овом случају „DbConnector”.
Ако желите да се смести на неко друго место, на крај команде можете додати неку другу путању.</p>
</div>
<div class="paragraph">
<p>Ако у овом тренутку извршите <code>git status</code>, приметићете неколико ствари.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git status
On branch master
Your branch is up-to-date with 'origin/master'.

Changes to be committed:
  (use "git reset HEAD &lt;file&gt;..." to unstage)

	new file:   .gitmodules
	new file:   DbConnector</code></pre>
</div>
</div>
<div class="paragraph">
<p>Најпре треба да приметите нови фајл <code>.gitmodules</code>.
Ово је конфигурациони фајл који чува мапирање између URL адресе пројекта и локалног директоријума у који сте га повукли:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cat .gitmodules
[submodule "DbConnector"]
	path = DbConnector
	url = https://github.com/chaconinc/DbConnector</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ако имате више подмодула, постојаће више ставки у овом фајлу.
Важно је приметите да је овај фајл део контроле верзије заједно са осталим фајловима, као што је ваш <code>.gitignore</code> фајл.
Гура се и повлачи заједно са остатком вашег пројекта.
На тај начин остали људи који клонирају овај пројекат знају одакле да преузму подмодул пројекте.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Белешка</div>
</td>
<td class="content">
<div class="paragraph">
<p>Пошто је URL у .gitmodules фајлу прво место одакле други људи покушају да клонирају/добаве, ако је то могуће, обезбедите да се користи URL адреса којој могу да приступе.
На пример, ако користите различиту URL адресу на коју гурате од оне са које остали повлаче, користите ону којој остали могу да приступе.
Ову вредност можете локално да препишете помоћу <code>git config submodule.DbConnector.url PRIVATE_URL</code> за вашу личну употребу.
Када је могућа, релативна URL адреса може бити од помоћи.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Други листинг у излазу команде <code>git status</code> је ставка директоријума пројекта.
Ако извршите <code>git diff</code> на њој, видећете нешто интересантно:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git diff --cached DbConnector
diff --git a/DbConnector b/DbConnector
new file mode 160000
index 0000000..c3f01dc
--- /dev/null
+++ b/DbConnector
@@ -0,0 +1 @@
+Subproject commit c3f01dc8862123d317dd46284b05b6892c7b29bc</code></pre>
</div>
</div>
<div class="paragraph">
<p>Мада је <code>DbConnector</code> поддиректоријум у вашем радном директоријуму, програм Гит га види као подмодул и не прати његов садржај када се не налазите у том директоријуму.
Уместо тога, Гит поддиректоријум види као одређени комит из тог репозиторијума.</p>
</div>
<div class="paragraph">
<p>Ако желите лепши приказ из команде <em>diff,</em> проследите опцију <code>--submodule</code> команди <code>git diff</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git diff --cached --submodule
diff --git a/.gitmodules b/.gitmodules
new file mode 100644
index 0000000..71fc376
--- /dev/null
+++ b/.gitmodules
@@ -0,0 +1,3 @@
+[submodule "DbConnector"]
+       path = DbConnector
+       url = https://github.com/chaconinc/DbConnector
Submodule DbConnector 0000000...c3f01dc (new submodule)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Када комитујете, видећете нешто овако:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git commit -am 'Add DbConnector module'
[master fb9093c] Add DbConnector module
 2 files changed, 4 insertions(+)
 create mode 100644 .gitmodules
 create mode 160000 DbConnector</code></pre>
</div>
</div>
<div class="paragraph">
<p>Уочите режим <code>160000</code> за ставку <code>DbConnector</code>.
То је посебан режим у програму Гит који у суштини значи да комит бележите као директоријум, а не поддиректоријум или фајл.</p>
</div>
<div class="paragraph">
<p>Коначно, гурните ове измене:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git push origin master</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h3 id="_cloning_submodules">Клонирање пројекта са подмодулима</h3>
<div class="paragraph">
<p>Овде ћемо клонирати пројекат који садржи подмодул.
Када клонирате један такав пројекат, подразумевано добијате директоријуме који садрже подмодуле, али ниједан од њих не садржи фајлове:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git clone https://github.com/chaconinc/MainProject
Cloning into 'MainProject'...
remote: Counting objects: 14, done.
remote: Compressing objects: 100% (13/13), done.
remote: Total 14 (delta 1), reused 13 (delta 0)
Unpacking objects: 100% (14/14), done.
Checking connectivity... done.
$ cd MainProject
$ ls -la
total 16
drwxr-xr-x   9 schacon  staff  306 Sep 17 15:21 .
drwxr-xr-x   7 schacon  staff  238 Sep 17 15:21 ..
drwxr-xr-x  13 schacon  staff  442 Sep 17 15:21 .git
-rw-r--r--   1 schacon  staff   92 Sep 17 15:21 .gitmodules
drwxr-xr-x   2 schacon  staff   68 Sep 17 15:21 DbConnector
-rw-r--r--   1 schacon  staff  756 Sep 17 15:21 Makefile
drwxr-xr-x   3 schacon  staff  102 Sep 17 15:21 includes
drwxr-xr-x   4 schacon  staff  136 Sep 17 15:21 scripts
drwxr-xr-x   4 schacon  staff  136 Sep 17 15:21 src
$ cd DbConnector/
$ ls
$</code></pre>
</div>
</div>
<div class="paragraph">
<p>Директоријум <code>DbConnector</code> је ту, али је празан.
Морате извршити две команде: <code>git submodule init</code> да иницијализујете свој локални конфигурациони фајл и <code>git submodule update</code> да преузмете све податке из тог пројекта и одјавите одговарајући комит наведен у вашем суперпројекту:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git submodule init
Submodule 'DbConnector' (https://github.com/chaconinc/DbConnector) registered for path 'DbConnector'
$ git submodule update
Cloning into 'DbConnector'...
remote: Counting objects: 11, done.
remote: Compressing objects: 100% (10/10), done.
remote: Total 11 (delta 0), reused 11 (delta 0)
Unpacking objects: 100% (11/11), done.
Checking connectivity... done.
Submodule path 'DbConnector': checked out 'c3f01dc8862123d317dd46284b05b6892c7b29bc'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Сада је ваш <code>DbConnector</code> поддиректоријум у потуно истом стању као што је био када сте малопре комитовали.</p>
</div>
<div class="paragraph">
<p>Постоји и један мало једноставнији начин да се ово уради.
Ако команди <code>git clone</code> наведете <code>--recurse-submodules</code>, она ће аутоматски да иницијализује и ажурира сваки подмодул у репозиторијуму, чак и угњеждене подмодуле у случају да неки од подмодула у репозиторијуму и сами поседују подмодуле.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git clone --recurse-submodules https://github.com/chaconinc/MainProject
Cloning into 'MainProject'...
remote: Counting objects: 14, done.
remote: Compressing objects: 100% (13/13), done.
remote: Total 14 (delta 1), reused 13 (delta 0)
Unpacking objects: 100% (14/14), done.
Checking connectivity... done.
Submodule 'DbConnector' (https://github.com/chaconinc/DbConnector) registered for path 'DbConnector'
Cloning into 'DbConnector'...
remote: Counting objects: 11, done.
remote: Compressing objects: 100% (10/10), done.
remote: Total 11 (delta 0), reused 11 (delta 0)
Unpacking objects: 100% (11/11), done.
Checking connectivity... done.
Submodule path 'DbConnector': checked out 'c3f01dc8862123d317dd46284b05b6892c7b29bc'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ако сте већ клонирали пројекат и заборавили да наведете <code>--recurse-submodules</code>, <code>git submodule init</code> и <code>git submodule update</code> кораке можете комбиновати извршавањем by running <code>git submodule update --init</code>.
Ако такође желите и да иницијализујете, преузмете и одјавите све постојеће угњеждене подмодуле, искористите беспрекорну <code>git submodule update --init --recursive</code>.</p>
</div>
</div>
<div class="sect3">
<h3 id="_рад_на_пројекту_са_подмодулима">Рад на пројекту са подмодулима</h3>
<div class="paragraph">
<p>Сада имамо копију пројекта који у себи има подмодуле и сарађиваћемо са члановима нашег тима и на главном и на подмодул пројекту.</p>
</div>
<div class="sect4">
<h4 id="_повлачење_узводних_измена_са_удаљеног_репозиторијума_подмодула">Повлачење узводних измена са удаљеног репозиторијума подмодула</h4>
<div class="paragraph">
<p>Најједноставнији модел коришћења подмодула у пројекту је када једноставно употребљавате потпројекат и желите да с времена на време преузмете његова ажурирања, али ништа не мењате у својој одјављеној верзији пројекта.
Хајде да прођемо кроз једноставни пример.</p>
</div>
<div class="paragraph">
<p>Ако желите проверити има ли новог рада у подмодулу, можете да одете у директоријум и извршите <code>git fetch</code> и <code>git merge</code> узводне гране чиме ажурирате локални кôд.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git fetch
From https://github.com/chaconinc/DbConnector
   c3f01dc..d0354fc  master     -&gt; origin/master
$ git merge origin/master
Updating c3f01dc..d0354fc
Fast-forward
 scripts/connect.sh | 1 +
 src/db.c           | 1 +
 2 files changed, 2 insertions(+)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ако се сада вратите назад у главни пројекат и извршите <code>git diff --submodule</code> видећете да је подмодул ажуриран и исписаће вам се листа комитова који су му додати.
Ако не желите да куцате <code>--submodule</code> сваки пут када извршавате <code>git diff</code>, то можете да подесите као подразумевани формат постављењем конфигурационе вредности <code>diff.submodule</code> на „log”.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git config --global diff.submodule log
$ git diff
Submodule DbConnector c3f01dc..d0354fc:
  &gt; more efficient db routine
  &gt; better connection routine</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ако у овом тренутку комитујете, онда ћете подмодул закључати тако да садржи нови кôд онда када остали људи ажурирају.</p>
</div>
<div class="paragraph">
<p>Постоји такође и лакши начин да се ово уради, ако вам се не свиђа да поддиректоријум ручно преузмете и спојите.
Ако извршите команду <code>git submodule update --remote</code>, програм Git ће прећи у ваш подмодуле и уместо вас урадити преузимање и ажурирање.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git submodule update --remote DbConnector
remote: Counting objects: 4, done.
remote: Compressing objects: 100% (2/2), done.
remote: Total 4 (delta 2), reused 4 (delta 2)
Unpacking objects: 100% (4/4), done.
From https://github.com/chaconinc/DbConnector
   3f19983..d0354fc  master     -&gt; origin/master
Submodule path 'DbConnector': checked out 'd0354fc054692d3906c85c3af05ddce39a1c0644'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ова команда ће подразумевано претпостављати да желите одјавити <code>master</code> грану подмодул репозиторијума.
Међутим, ако желите, то можете поставити на нешто друго.
На пример, ако желите да <em>DbConnector</em> подмодул прати „stable” грану тог репозиторијума, можете то да подесите или у свом <code>.gitmodules</code> фајлу (тако да је и сви остали прате), или само у свом локалном <code>.git/config</code> фајлу.
Хајде да је поставимо у <code>.gitmodules</code> фајлу:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git config -f .gitmodules submodule.DbConnector.branch stable

$ git submodule update --remote
remote: Counting objects: 4, done.
remote: Compressing objects: 100% (2/2), done.
remote: Total 4 (delta 2), reused 4 (delta 2)
Unpacking objects: 100% (4/4), done.
From https://github.com/chaconinc/DbConnector
   27cf5d3..c87d55d  stable -&gt; origin/stable
Submodule path 'DbConnector': checked out 'c87d55d4c6d4b05ee34fbc8cb6f7bf4585ae6687'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ако изоставите <code>-f .gitmodules</code> измена ће важити само за вас, али вероватно има више смисла да се та информација прати у репозиторијуму, тако да сви остали то раде.</p>
</div>
<div class="paragraph">
<p>Када у овом тренутку извршимо <code>git status</code>, програм Гит ће нам приказати да имамо „new commits” (нове комитове) у подмодулу.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git status
On branch master
Your branch is up-to-date with 'origin/master'.

Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)

  modified:   .gitmodules
  modified:   DbConnector (new commits)

no changes added to commit (use "git add" and/or "git commit -a")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ако подесите конфигурационо подешавање <code>status.submodulesummary</code>, програм Гит
ће вам такође приказати и кратак резиме измена у вашим подмодулима:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git config status.submodulesummary 1

$ git status
On branch master
Your branch is up-to-date with 'origin/master'.

Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)

	modified:   .gitmodules
	modified:   DbConnector (new commits)

Submodules changed but not updated:

* DbConnector c3f01dc...c87d55d (4):
  &gt; catch non-null terminated lines</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ако у овом тренутку извршимо <code>git diff</code> видећемо и да нам је измењен <code>.gitmodules</code> фајл и да такође постоји већи број комитова које смо повукли и који су спремни за комит у нашем подмодул пројекту.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git diff
diff --git a/.gitmodules b/.gitmodules
index 6fc0b3d..fd1cc29 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -1,3 +1,4 @@
 [submodule "DbConnector"]
        path = DbConnector
        url = https://github.com/chaconinc/DbConnector
+       branch = stable
 Submodule DbConnector c3f01dc..c87d55d:
  &gt; catch non-null terminated lines
  &gt; more robust error handling
  &gt; more efficient db routine
  &gt; better connection routine</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ово је заиста одлично јер можемо да видимо лог комитова које ћемо управо комитовати у наш подмодул.
Након комитовања, ту информацију можете видети када извршите <code>git log -p</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git log -p --submodule
commit 0a24cfc121a8a3c118e0105ae4ae4c00281cf7ae
Author: Scott Chacon &lt;schacon@gmail.com&gt;
Date:   Wed Sep 17 16:37:02 2014 +0200

    updating DbConnector for bug fixes

diff --git a/.gitmodules b/.gitmodules
index 6fc0b3d..fd1cc29 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -1,3 +1,4 @@
 [submodule "DbConnector"]
        path = DbConnector
        url = https://github.com/chaconinc/DbConnector
+       branch = stable
Submodule DbConnector c3f01dc..c87d55d:
  &gt; catch non-null terminated lines
  &gt; more robust error handling
  &gt; more efficient db routine
  &gt; better connection routine</code></pre>
</div>
</div>
<div class="paragraph">
<p>Када извршите <code>git submodule update --remote</code>, програм Гит ће подразумевано покушати да ажурира <strong>све</strong> ваше подмодуле.
Ако их имате доста, вероватно ћете пожелети да проследите име оног подмодула за који желите да се покуша ажурирање.</p>
</div>
</div>
<div class="sect4">
<h4 id="_повлачење_узводних_измена_са_удаљеног_репозиторијума_пројекта">Повлачење узводних измена са удаљеног репозиторијума пројекта</h4>
<div class="paragraph">
<p>Хајде да сада ускочимо у ципеле вашег сарадника који има сопствени локални клон репозиторијума <em>MainProject</em>.
Просто извршавање <code>git pull</code> за преузимање свеже комитованих измена није довољно:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git pull
From https://github.com/chaconinc/MainProject
   fb9093c..0a24cfc  master     -&gt; origin/master
Fetching submodule DbConnector
From https://github.com/chaconinc/DbConnector
   c3f01dc..c87d55d  stable     -&gt; origin/stable
Updating fb9093c..0a24cfc
Fast-forward
 .gitmodules         | 2 +-
 DbConnector         | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

$ git status
 On branch master
Your branch is up-to-date with 'origin/master'.
Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)

	modified:   DbConnector (new commits)

Submodules changed but not updated:

* DbConnector c87d55d...c3f01dc (4):
  &lt; catch non-null terminated lines
  &lt; more robust error handling
  &lt; more efficient db routine
  &lt; better connection routine

no changes added to commit (use "git add" and/or "git commit -a")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Команда <code>git pull</code> подразумевано рекурзивно преузима измене подмодула, као што видимо изнад у излазу прве команде.
Међутим, она не <strong>ажурира</strong> подмодуле.
Ово се види у излазу <code>git status</code> команде који приказује да је подмодул „modified” (измењен) и да има „new commits” (нове комитове).
Уз то, заграде говоре да нови комитови показују улево (&lt;), што значи да су ти комитови забележени у <em>MainProject</em> али нису присутни у локалном <em>DbConnector</em> одјављивању.
Да бисте довршили ажурирање, морате да извршите <code>git submodule update</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git submodule update --init --recursive
Submodule path 'vendor/plugins/demo': checked out '48679c6302815f6c76f1fe30625d795d9e55fc56'

$ git status
 On branch master
Your branch is up-to-date with 'origin/master'.
nothing to commit, working tree clean</code></pre>
</div>
</div>
<div class="paragraph">
<p>Да бисте били сигурни, приметите да би <code>git submodule update</code> требало да извршите са заставицом <code>--init</code> у случају да су нови <em>MainProject</em> комитови које сте управо повукли додали нове подмодуле и са <code>--recursive</code> заставицом за случај да неки од подмодула имају угњеждено подмодуле.</p>
</div>
<div class="paragraph">
<p>Ако овај процес желите да аутоматизујете, команди <code>git pull</code> (почевши од Гит верзије 2.14) можете да додате заставицу <code>--recurse-submodules</code>.
Ово ће наложити програму Гит да изврши <code>git submodule update</code> непосредно након повлачења, постављајући подмодуле у исправно стање.
Уз то, ако желите да програм Гит увек повлачи са <code>--recurse-submodules</code>, можете да поставите конфигурациону опцију <code>submodule.recurse</code> на <em>true</em> (ово функционише за <code>git pull</code> почевши од верзије 2.15 програма Гит).
Ова опција ће навести програм Гит да заставицу <code>--recurse-submodules</code> употребљава за све команде које је подржавају (осим <code>clone</code>).</p>
</div>
<div class="paragraph">
<p>Постоји специјална ситуација која може да се догоди када се повлаче ажурирања суперпројекта: може се десити да је у једном од комитова које повлачите узводни репозиторијум променио URL адресу подмодула у <code>.gitmodules</code> фајлу.
Ово може да се деси, на пример, ако This can happen for example if the submodule project changes its hosting platform.
У том случају је могуће да <code>git pull --recurse-submodules</code> или <code>git submodule update</code> не успеју да се изврше ако суперпројекат указује на комит подмодула који не може да се нађе у удаљеном репозиторијуму подмодула локално конфигурисаном у вашем репозиторијуму.
Да би се решила ова ситуација, потребна је команда <code>git submodule sync</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console"># копира нову URL адресу у вашу локалну конфигурацију
$ git submodule sync --recursive
# ажурира подмодул са нове URL адресе
$ git submodule update --init --recursive</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h4 id="_рад_на_подмодулу">Рад на подмодулу</h4>
<div class="paragraph">
<p>Врло је вероватно да ако користите подмодуле, то чините јер заиста желите да радите на коду у подмодулу истовремено уз рад на коду главног пројекта (или преко неколико подмодула).
У супротном бисте сигурно користили једноставнији систем за управљање зависностима (као што је <em>Maven</em> или <em>Rubygems).</em></p>
</div>
<div class="paragraph">
<p>Па хајде да сада прођемо кроз пример прављења измена у подмодулу истовремено са изменама у главном пројекту и комитовање и објављивање тих измена у исто време.</p>
</div>
<div class="paragraph">
<p>До сада, кадгод смо извршавали команду <code>git submodule update</code> да преузмемо измене из репозиторијума подмодула, програм Гит би преузео измене и ажурирао фајлове у поддиректоријуму, али би под-репозиторијум оставио у такозваном „detached HEAD” (одвојен HEAD) стању.
То значи да нема локалне радне гране (као што је <code>master</code>, на пример) која прати измене.
Када нема радне гране која прати измене, чак и ако комитујете измене у подмодулу, оне ће највероватније изгубити када следећи пут извршите <code>git submodule update</code>.
Морате урадите неке додатне кораке ако желите да се измене у подмодулу прате.</p>
</div>
<div class="paragraph">
<p>Ако подмодул желите подесити тако да буде лакше да само уђете у њега и почнете да дељете, морате урадити две ствари.
Потребно је да уђете у сваки подмодул и одјавите грану у којој ћете радити.
Затим програму Гит морате рећи шта да ради ако сте направили измене, а <code>git submodule update --remote</code> он да повуче нови рад са узводног репозиторијума.
Имате две опције: можете да их спојите у свој локални рад, или можете покушати да ребазирате свој локални рад на врх нових измена.</p>
</div>
<div class="paragraph">
<p>Најпре, хајде да одемо у директоријум подмодула и одјавимо грану.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cd DbConnector/
$ git checkout stable
Switched to branch 'stable'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Покушајмо да „merge” опцијом ажурирамо наш подмодул.
Ручно је наводимо тако што <code>update</code> позиву једноставно додамо опцију <code>--merge</code>.
Овде ћемо видети да је на серверу дошло до промене за овај подмодул и она се спаја.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cd ..
$ git submodule update --remote --merge
remote: Counting objects: 4, done.
remote: Compressing objects: 100% (2/2), done.
remote: Total 4 (delta 2), reused 4 (delta 2)
Unpacking objects: 100% (4/4), done.
From https://github.com/chaconinc/DbConnector
   c87d55d..92c7337  stable     -&gt; origin/stable
Updating c87d55d..92c7337
Fast-forward
 src/main.c | 1 +
 1 file changed, 1 insertion(+)
Submodule path 'DbConnector': merged in '92c7337b30ef9e0893e758dac2459d07362ab5ea'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ако пређемо у <em>DbConnector</em> директоријум, видећемо да су нове измене већ спојене у нашу локалну <code>stable</code> грану.
Хајде сада да видимо шта се дешава када направимо локалну измену библиотеке па неко други у исти време гурне узводно другу промену.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cd DbConnector/
$ vim src/db.c
$ git commit -am 'Unicode support'
[stable f906e16] Unicode support
 1 file changed, 1 insertion(+)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Аса сада ажурирамо свој подмодул видећемо шта се дешава у случају када смо направили локалну измену, а постоји и узводна измена коју морамо да уведемо.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cd ..
$ git submodule update --remote --rebase
First, rewinding head to replay your work on top of it...
Applying: Unicode support
Submodule path 'DbConnector': rebased into '5d60ef9bbebf5a0c1c1050f242ceeb54ad58da94'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ако заборавите да наведете <code>--rebase</code> или <code>--merge</code>, програм Гит ће једноставно ажурирати подмодул на оно што се налази на серверу и ресетоваће ваш пројекат на стање одвојен HEAD.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git submodule update --remote
Submodule path 'DbConnector': checked out '5d60ef9bbebf5a0c1c1050f242ceeb54ad58da94'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ако се то догоди, не брините, једноставно се можете вратити назад у директоријум и поново одјавити своју грану (која још увек садржи ваш рад) и ручно спојити или ребазирати <code>origin/stable</code> (или коју год удаљену грану желите).</p>
</div>
<div class="paragraph">
<p>Ако своје измене подмодула још увек увек нисте комитовали, па покренете ажурирање подмодула, имаћете проблема, програм Гит ће преузети измене али неће преписати несачуван рад у вашем директоријуму подмодула.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git submodule update --remote
remote: Counting objects: 4, done.
remote: Compressing objects: 100% (3/3), done.
remote: Total 4 (delta 0), reused 4 (delta 0)
Unpacking objects: 100% (4/4), done.
From https://github.com/chaconinc/DbConnector
   5d60ef9..c75e92a  stable     -&gt; origin/stable
error: Your local changes to the following files would be overwritten by checkout:
	scripts/setup.sh
Please, commit your changes or stash them before you can switch branches.
Aborting
Unable to checkout 'c75e92a2b3855c9e5b66f915308390d9db204aca' in submodule path 'DbConnector'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ако сте направили измене које су у конфликту са нечим што се променило узводно, програм Гит ће вас обавестити о томе када покренете ажурирање.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git submodule update --remote --merge
Auto-merging scripts/setup.sh
CONFLICT (content): Merge conflict in scripts/setup.sh
Recorded preimage for 'scripts/setup.sh'
Automatic merge failed; fix conflicts and then commit the result.
Unable to merge 'c75e92a2b3855c9e5b66f915308390d9db204aca' in submodule path 'DbConnector'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Можете отићи у директоријум подмодула и исправити конфликте, као што бисте и иначе урадили.</p>
</div>
</div>
<div class="sect4">
<h4 id="_publishing_submodules">Објављивање измена подмодула</h4>
<div class="paragraph">
<p>Сада имамо неке измене у нашем директоријуму подмодула.
Неке од њих су дошле узводно кроз наше ажурирање, а остале су урађене локално и још увек никоме нису доступне јер их нисмо објавили.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git diff
Submodule DbConnector c87d55d..82d2ad3:
  &gt; Merge from origin/stable
  &gt; Update setup script
  &gt; Unicode support
  &gt; Remove unnecessary method
  &gt; Add new option for conn pooling</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ако комитујемо у главном пројекту и гурнемо га узводно, а да не гурнемо и измене у подмодулу, остали људи који покушају да одјаве наше измене биће у проблему јер неће имати начина да дођу до измена подмодула од којих зависе.
Те измене ће постојати само у нашој локалној копији.</p>
</div>
<div class="paragraph">
<p>Ако желите обезбедити да до овога не дође, можете затражити од програма Гит да провери да ли су сви важи подмодули исправно гурнути пре него што гурне главни пројекат.
Команда <code>git push</code> узима <code>--recurse-submodules</code> аргумент који може да се постави било на  „check” или на „on-demand”.
Опција „check” ће учинити да <code>push</code> једноставно не успе са извршавањем ако било које од комитованих измена подмодула нису још увек гурнуте.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git push --recurse-submodules=check
The following submodule paths contain changes that can
not be found on any remote:
  DbConnector

Please try

	git push --recurse-submodules=on-demand

or cd to the path and use

	git push

to push them to a remote.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Као што видите, команда вам приказује и корисне савете у вези могућих наредних корака.
Једноставна могућност је да пређете у сваки подмодул и да ручно гурнете на удаљене репозиторијуме и тако обезбедите да су доступни споља када поново покушате гурање главног пројекта
Ако желите да се ово понашање провере дешава за сва гурања, поставите га да буде подразумевано са <code>git config push.recurseSubmodules check</code>.</p>
</div>
<div class="paragraph">
<p>Друга могућност је да се користи вредност „on-demand” која ће ово покушати да уради уместо вас.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git push --recurse-submodules=on-demand
Pushing submodule 'DbConnector'
Counting objects: 9, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (8/8), done.
Writing objects: 100% (9/9), 917 bytes | 0 bytes/s, done.
Total 9 (delta 3), reused 0 (delta 0)
To https://github.com/chaconinc/DbConnector
   c75e92a..82d2ad3  stable -&gt; stable
Counting objects: 2, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (2/2), done.
Writing objects: 100% (2/2), 266 bytes | 0 bytes/s, done.
Total 2 (delta 1), reused 0 (delta 0)
To https://github.com/chaconinc/MainProject
   3d6d338..9a377d1  master -&gt; master</code></pre>
</div>
</div>
<div class="paragraph">
<p>Као што видите, програм Гит је прешао у <em>DbConnector</em> модул у гурнуо га пре него што је гурнуо главни пројекат.
Ако из неког разлога ро гурање не успе, неће успети ни гурање главног пројекта.
Ово понашање можете поставити као подразумевано извршавањем <code>git config push.recurseSubmodules on-demand</code>.</p>
</div>
</div>
<div class="sect4">
<h4 id="_спајање_измена_подмодула">Спајање измена подмодула</h4>
<div class="paragraph">
<p>Ако измените референцу на подмодул у исто време кад и неко други, можете наићи на проблеме.
То јест, ако су се историје подмодула разишле и комитоване у одвојене гране суперпројекта, биће потребно мало рада да то поправите.</p>
</div>
<div class="paragraph">
<p>Ако је један од комитова директни предак другог (спајање методом брзог премотавања унапред), онда ће програм Гит за спајање једноставно изабрати тај други и то лепо функционише.</p>
</div>
<div class="paragraph">
<p>Међутим, програм Гит уместо вас неће покушати чак ни тривијално спајање.
Ако се комитови подмодула разилазе и потребно је да се споје, видећете нешто слично овоме:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git pull
remote: Counting objects: 2, done.
remote: Compressing objects: 100% (1/1), done.
remote: Total 2 (delta 1), reused 2 (delta 1)
Unpacking objects: 100% (2/2), done.
From https://github.com/chaconinc/MainProject
   9a377d1..eb974f8  master     -&gt; origin/master
Fetching submodule DbConnector
warning: Failed to merge submodule DbConnector (merge following commits not found)
Auto-merging DbConnector
CONFLICT (submodule): Merge conflict in DbConnector
Automatic merge failed; fix conflicts and then commit the result.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Оно што се у суштини десило овде је да је програм Гит открио да све гране бележе тачке у историји подмодула које се разилазе и потребно је да се споје.
Он то објашњава као „merge following commits not found” (није пронађено спајање након комитова), што донекле збуњује, па ћемо ускоро објаснити зашто је тако.</p>
</div>
<div class="paragraph">
<p>Да бисте решили проблем, потребно је да одредите стање у којем подмодул треба да се налази.
Чудно, али програм Гит вам у овој ситуација не пружа доста информација које могу да вам помогну, чак ни SHA-1 суме комитова са обе стране историје.
Не срећу, ово једноставно може да се одреди.
Ако извршите <code>git diff</code> видећете SHA-1s суме комитова који су забележени у обе гране које покушавате да спојите.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git diff
diff --cc DbConnector
index eb41d76,c771610..0000000
--- a/DbConnector
+++ b/DbConnector</code></pre>
</div>
</div>
<div class="paragraph">
<p>Дакле, у овом случају је <code>eb41d76</code> комит у нашем подмодулу који <strong>ми</strong> имамо, а <code>c771610</code> је комит који долази узводно.
Ако пређемо у директоријум подмодула, већ би требало да се налази на <code>eb41d76</code> јер спајање није утицало на њега.
Ако из било ког разлога није тако, једноставно можете да креирате и одјавите грану која показује на њега.</p>
</div>
<div class="paragraph">
<p>Важна је SHA-1 сума комита са друге стране.
То је оно што треба да спојите и да разрешите.
Можете просто да пробате спајање директно са SHA-1, или можете креирати грану за њега, па покушати њу да спојите.
Ми предлажемо ово друго, ако ништа друго, да бисмо могли написати лепшу поруку за комит спајања.</p>
</div>
<div class="paragraph">
<p>Дакле, прећи ћемо у директоријум подмодула, направићемо грану базирану на том другом SHA-1 из излаза комаде <code>git diff</code> и ручно ћемо да је спојимо.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cd DbConnector

$ git rev-parse HEAD
eb41d764bccf88be77aced643c13a7fa86714135

$ git branch try-merge c771610

$ git merge try-merge
Auto-merging src/main.c
CONFLICT (content): Merge conflict in src/main.c
Recorded preimage for 'src/main.c'
Automatic merge failed; fix conflicts and then commit the result.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Овде је дошло до конфликта при спајању, тако да ако га разрешимо и комитујемо, онда једноставно можемо да ажурирамо главни пројекат тим резултатом.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ vim src/main.c <b class="conum">(1)</b>
$ git add src/main.c
$ git commit -am 'merged our changes'
Recorded resolution for 'src/main.c'.
[master 9fd905e] merged our changes

$ cd .. <b class="conum">(2)</b>
$ git diff <b class="conum">(3)</b>
diff --cc DbConnector
index eb41d76,c771610..0000000
--- a/DbConnector
+++ b/DbConnector
@@@ -1,1 -1,1 +1,1 @@@
- Subproject commit eb41d764bccf88be77aced643c13a7fa86714135
 -Subproject commit c77161012afbbe1f58b5053316ead08f4b7e6d1d
++Subproject commit 9fd905e5d7f45a0d4cbc43d1ee550f16a30e825a
$ git add DbConnector <b class="conum">(4)</b>

$ git commit -m "Merge Tom's Changes" <b class="conum">(5)</b>
[master 10d2c60] Merge Tom's Changes</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Прво разрешимо конфликт.</p>
</li>
<li>
<p>Затим се вратимо у директоријум главног пројекта.</p>
</li>
<li>
<p>Можемо поново да проверимо SHA-1 суме.</p>
</li>
<li>
<p>Означимо да је ставка подмодула у конфликту решена.</p>
</li>
<li>
<p>Комитујемо спајање.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Можда помало збуњује, али заиста није тешко.</p>
</div>
<div class="paragraph">
<p>Интересантно је да постоји још један случај који програм Гит сам обрађује.
Ако у директоријуму подмодула постоји комит спајања који у својој историји садржи <strong>оба</strong> комита, програм Гит ће вам то предложити као могуће решење.
Он види да је у неком тренутку подмодул пројекта неко спојио гране које садрже ова два комита, па је могуће да ћете пожелети тај.</p>
</div>
<div class="paragraph">
<p>Ово је разлог што се приказује порука „merge following commits not found”, јер није био у стању да уради <strong>ово</strong>.
Забуну уноси питање да ли би било ко и очекивао да програм Гит ово <strong>покуша</strong>?</p>
</div>
<div class="paragraph">
<p>Ако пронађе макар један прихватљиви комит спајања, видећете нешто слично овоме:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git merge origin/master
warning: Failed to merge submodule DbConnector (not fast-forward)
Found a possible merge resolution for the submodule:
 9fd905e5d7f45a0d4cbc43d1ee550f16a30e825a: &gt; merged our changes
If this is correct simply add it to the index for example
by using:

  git update-index --cacheinfo 160000 9fd905e5d7f45a0d4cbc43d1ee550f16a30e825a "DbConnector"

which will accept this suggestion.
Auto-merging DbConnector
CONFLICT (submodule): Merge conflict in DbConnector
Automatic merge failed; fix conflicts and then commit the result.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Команда коју програм Гит предлаже ће ажурирати индекс исто као да сте извршили <code>git add</code> (што означава да је конфликт разрешен), па затим комитује.
Мада то вероватно не би требало да урадите.
Исто тако можете лако да одете у директоријум подмодула, погледате шта је разлика, брзо премотате унапред на овај комит, тестирате га како треба, па га онда комитујете.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cd DbConnector/
$ git merge 9fd905e
Updating eb41d76..9fd905e
Fast-forward

$ cd ..
$ git add DbConnector
$ git commit -am 'Fast forward to a common submodule child'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ово постиже исти резултат, али барем можете проверити да функционише и када завршите имате кôд у директоријуму свог подмодула.</p>
</div>
</div>
</div>
<div class="sect3">
<h3 id="_савети_за_подмодуле">Савети за подмодуле</h3>
<div class="paragraph">
<p>Постоји неколико ствари које могу да вам олакшају рад са подмодулима.</p>
</div>
<div class="sect4">
<h4 id="_submodule_foreach">Submodule Foreach</h4>
<div class="paragraph">
<p>Постоји <code>foreach</code> подмодул команда која служи за извршавање произвољне комаде у сваком од подмодула.
Ово може доста да помогне ако у истом пројекту имате већи број подмодула.</p>
</div>
<div class="paragraph">
<p>На пример, рецимо да желимо почети рад на новој могућности или да исправимо баг, а рад се одвија у више подмодула.
Лако можемо да сакријемо комплетан рад у свим нашим подмодулима.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git submodule foreach 'git stash'
Entering 'CryptoLibrary'
No local changes to save
Entering 'DbConnector'
Saved working directory and index state WIP on stable: 82d2ad3 Merge from origin/stable
HEAD is now at 82d2ad3 Merge from origin/stable</code></pre>
</div>
</div>
<div class="paragraph">
<p>Затим можемо да креирамо нову грану и пређемо на њу у свим нашим подмодулима.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git submodule foreach 'git checkout -b featureA'
Entering 'CryptoLibrary'
Switched to a new branch 'featureA'
Entering 'DbConnector'
Switched to a new branch 'featureA'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Схватате поенту.
Једна заиста корисна ствар коју можете да урадите је да направите лепу уједињену разлику онога што је промењено у главном пројекту, као и у свим потпројектима.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git diff; git submodule foreach 'git diff'
Submodule DbConnector contains modified content
diff --git a/src/main.c b/src/main.c
index 210f1ae..1f0acdc 100644
--- a/src/main.c
+++ b/src/main.c
@@ -245,6 +245,8 @@ static int handle_alias(int *argcp, const char ***argv)

      commit_pager_choice();

+     url = url_decode(url_orig);
+
      /* build alias_argv */
      alias_argv = xmalloc(sizeof(*alias_argv) * (argc + 1));
      alias_argv[0] = alias_string + 1;
Entering 'DbConnector'
diff --git a/src/db.c b/src/db.c
index 1aaefb6..5297645 100644
--- a/src/db.c
+++ b/src/db.c
@@ -93,6 +93,11 @@ char *url_decode_mem(const char *url, int len)
        return url_decode_internal(&amp;url, len, NULL, &amp;out, 0);
 }

+char *url_decode(const char *url)
+{
+       return url_decode_mem(url, strlen(url));
+}
+
 char *url_decode_parameter_name(const char **query)
 {
        struct strbuf out = STRBUF_INIT;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Овде можемо видети да дефинишемо функцију у подмодулу и позивамо је из главног пројекта.
Ово је очигледно упрошћен пример, али надамо се да вам даје представу колико може бити корисно.</p>
</div>
</div>
<div class="sect4">
<h4 id="_корисни_алијаси">Корисни алијаси</h4>
<div class="paragraph">
<p>Вероватно ћете хтети да поставите неколико алијаса за неке од ових команди, јер могу бити прилично дугачке и за већину не можете поставити подразумеване опције конфигурацијом.
Постављање алијаса у програму Гит смо објаснили у covered setting up Git aliases in <a href="{{< relurl "book/sr/v2/ch00/_git_aliases" >}}">Гит алијаси</a>, али овде дајемо пример шта можете поставити ако планирате доста да радите са подмодулима у програму Гит.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git config alias.sdiff '!'"git diff &amp;&amp; git submodule foreach 'git diff'"
$ git config alias.spush 'push --recurse-submodules=on-demand'
$ git config alias.supdate 'submodule update --remote --merge'</code></pre>
</div>
</div>
<div class="paragraph">
<p>На овај начин једноставно можете извршити <code>git supdate</code> кадгод желите да ажурирате своје подмодуле, или <code>git spush</code> да гурнете подмодул уз проверу зависности.</p>
</div>
</div>
</div>
<div class="sect3">
<h3 id="_проблеми_са_подмодулима">Проблеми са подмодулима</h3>
<div class="paragraph">
<p>Међутим, употреба подмодула није тако глатка.</p>
</div>
<div class="sect4">
<h4 id="_пребацивање_грана">Пребацивање грана</h4>
<div class="paragraph">
<p>На пример, пребацивање са гране на грану која у себи има подмодуле може бити компликовано.
Ако креирате нову грану, тамо додате подмодул, па се вратите назад на грану без подмодула, још увек ћете имати директоријум подмодула као непраћен директоријум:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git --version
git version 2.12.2

$ git checkout -b add-crypto
Switched to a new branch 'add-crypto'

$ git submodule add https://github.com/chaconinc/CryptoLibrary
Cloning into 'CryptoLibrary'...
...

$ git commit -am 'Add crypto library'
[add-crypto 4445836] Add crypto library
 2 files changed, 4 insertions(+)
 create mode 160000 CryptoLibrary

$ git checkout master
warning: unable to rmdir CryptoLibrary: Directory not empty
Switched to branch 'master'
Your branch is up-to-date with 'origin/master'.

$ git status
On branch master
Your branch is up-to-date with 'origin/master'.

Untracked files:
  (use "git add &lt;file&gt;..." to include in what will be committed)

	CryptoLibrary/

nothing added to commit but untracked files present (use "git add" to track)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Уклањање директоријума није тако тешко, али збуњује то што га уопште имате тамо.
Ако га уклоните, па се онда вратите назад на грану која има тај подмодул, мораћете да извршите <code>submodule update --init</code> да бисте га поново попунили.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git clean -ffdx
Removing CryptoLibrary/

$ git checkout add-crypto
Switched to branch 'add-crypto'

$ ls CryptoLibrary/

$ git submodule update --init
Submodule path 'CryptoLibrary': checked out 'b8dda6aa182ea4464f3f3264b11e0268545172af'

$ ls CryptoLibrary/
Makefile	includes	scripts		src</code></pre>
</div>
</div>
<div class="paragraph">
<p>Да поновимо, није толико компликовано, али помало збуњује.</p>
</div>
<div class="paragraph">
<p>Новије верзије програма Гит (Git &gt;= 2.13) све ово поједностављују додавањем заставице  <code>--recurse-submodules</code> команди <code>git checkout</code> која брине о постављању подмодула у стање које одговара грани на коју прелазимо.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git --version
git version 2.13.3

$ git checkout -b add-crypto
Switched to a new branch 'add-crypto'

$ git submodule add https://github.com/chaconinc/CryptoLibrary
Cloning into 'CryptoLibrary'...
...

$ git commit -am 'Add crypto library'
[add-crypto 4445836] Add crypto library
 2 files changed, 4 insertions(+)
 create mode 160000 CryptoLibrary

$ git checkout --recurse-submodules master
Switched to branch 'master'
Your branch is up-to-date with 'origin/master'.

$ git status
On branch master
Your branch is up-to-date with 'origin/master'.

nothing to commit, working tree clean</code></pre>
</div>
</div>
<div class="paragraph">
<p>Употреба заставице <code>--recurse-submodules</code> команде <code>git checkout</code> такође може бити корисно када радите на неколико грана суперпројекта, а свака од њих има ваше подмодуле који показују на различите комитове.
Заиста, ако пређете са гране на грану која не бележи подмодул на истом комиту, након извршавања команде <code>git status</code> подмодул ће се појавити као „modified” (измењен) и означаваће „new commits” (нови комитови).
Разлог за ово је што се стање подмодула подразумевано не преноси приликом преласка на другу грану.</p>
</div>
<div class="paragraph">
<p>Ово заиста може уносити забуну, тако да је добра идеја да увек извршавате <code>git checkout --recurse-submodules</code> када ваш пројекат има подмодуле.
У старијим верзијама програма Гит које немају заставицу <code>--recurse-submodules</code>, након одјављивања можете употребити <code>git submodule update --init --recursive</code> и тако поставите подмодуле у одговарајуће стање.</p>
</div>
<div class="paragraph">
<p>Срећом, програму Гит (&gt;=2.14) можете конфигурационом опцијом <code>submodule.recurse</code> навести да увек корсити заставицу <code>--recurse-submodules</code>: <code>git config submodule.recurse true</code>.
Као што је напоменуто изнад, то ће навести програм Гит да рекурзивно посети подмодуле за свку команду која у себи има наведену опцију <code>--recurse-submodules</code> (осим <code>git clone</code>).</p>
</div>
</div>
<div class="sect4">
<h4 id="_претварање_поддиректоријума_у_подмодуле">Претварање поддиректоријума у подмодуле</h4>
<div class="paragraph">
<p>Друго главно ограничење на које многи људи наиђу се тиче претварања поддиректоријума у подмодуле.
Ако сте у свом пројекту пратили фајлове и желите да их померите у подмодул, морате бити опрезни иначе ће програм Гит да се наљути на вас.
Претпоставимо да имате фајлове у поддиректоријуму свог пројекта и да желите да га претворите у подмодул.
Ако обришете поддиректоријум па онда извршите <code>submodule add</code>, програм Гит вам каже следеће:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ rm -Rf CryptoLibrary/
$ git submodule add https://github.com/chaconinc/CryptoLibrary
'CryptoLibrary' already exists in the index</code></pre>
</div>
</div>
<div class="paragraph">
<p>Директоријум <code>CryptoLibrary</code> најпре морате да уклоните са стејџа.
Након тога можете да додате подмодул:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git rm -r CryptoLibrary
$ git submodule add https://github.com/chaconinc/CryptoLibrary
Cloning into 'CryptoLibrary'...
remote: Counting objects: 11, done.
remote: Compressing objects: 100% (10/10), done.
remote: Total 11 (delta 0), reused 11 (delta 0)
Unpacking objects: 100% (11/11), done.
Checking connectivity... done.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Претпоставимо сада да сте то урадили у грани.
Ако покушате да се вратите на грану у којој су ти фајлови још увек у стаблу, а не у подмодулу, враћа вам се следеће грешка:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git checkout master
error: The following untracked working tree files would be overwritten by checkout:
  CryptoLibrary/Makefile
  CryptoLibrary/includes/crypto.h
  ...
Please move or remove them before you can switch branches.
Aborting</code></pre>
</div>
</div>
<div class="paragraph">
<p>Можете принудно да пређете са <code>checkout -f</code>, али будите пажљиви да тамо немате несачуване измене јер би ова команда могла да их препише.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git checkout -f master
warning: unable to rmdir CryptoLibrary: Directory not empty
Switched to branch 'master'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Затим, када се вратите назад, имате празан <code>CryptoLibrary</code> директоријум и можда га ни <code>git submodule update</code> не поправи.
Потребно је да се вратите и директоријум подмодула и извршите <code>git checkout .</code> да вратите назад све своје фајлове.
Ово бисте могли да извршите у <code>submodule foreach</code> скрипти ако имате више подмодула.</p>
</div>
<div class="paragraph">
<p>Важно је приметите да у данашње време подмодули чувају све своје Гит податке у <code>.git</code> директоријуму основног пројекта, за разлико од много старијих верзија програма Гит, уништавање директоријума подмодула нећете изгубити ниједан комит или грану коју сте имали.</p>
</div>
<div class="paragraph">
<p>Уз ове алате, подмодули могу да буду прилично једноставан и ефективан метод за истовремено развијање неколико повезаних, али ипак одвојених пројеката.</p>
</div>
</div>
</div>
<div id="nav"><a href="{{< previous-section >}}">prev</a> | <a href="{{< next-section >}}">next</a></div>