---
### DO NOT EDIT! Generated by script/update-book2.rb
category: book
section: documentation
subsection: book
sidebar: book
book:
  language_code: uk
  chapter:
    title: Інструменти Git
    number: 7
  section:
    title: Пакування
    number: 12
    cs_number: '7.12'
    previous: book/uk/v2/Інструменти-Git-Підмодулі
    next: book/uk/v2/Інструменти-Git-Заміна
title: Git - Пакування
url: "/book/uk/v2/Інструменти-Git-Пакування.html"
---
<h2 id="_bundling">Пакування</h2>
<div class="paragraph">
<p>Хоч ми й розглянули звичайні способи передачі даних через мережу (HTTP, SSH тощо), насправді існує ще один, не такий поширений метод зробити це, що іноді може бути доволі корисним.</p>
</div>
<div class="paragraph">
<p>Git здатен до “пакування” (bundling) своїх даних в один файл.
Це може бути корисним у різноманітних випадках.
Можливо, ваша мережа не працює, а ви бажаєте відправити свої зміни співробітникам.
Мабуть, ви працюєте десь поза офісом та не маєте доступу до локальної мережі через заходи безпеки.
Можливо, ваша мережева картка просто зламалась.
Можливо, наразі у вас немає доступу до спільного сервера, ви бажаєте надіслати електронного листа з оновленнями, проте не бажаєте відправляти 40 комітів через <code>format-patch</code>.</p>
</div>
<div class="paragraph">
<p>Ось тоді команда <code>git bundle</code> може допомогти.
Команда <code>bundle</code> спакує все, що зазвичай передається через дріт командою <code>git push</code>, у двійковий файл, який ви можете передати поштою або записати на флеш-накопичувач, а потім розпакувати його в інший репозиторій.</p>
</div>
<div class="paragraph">
<p>Розгляньмо простий приклад.
Скажімо, у вас є репозиторій з двома комітами:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git log
commit 9a466c572fe88b195efd356c3f2bbeccdb504102
Author: Scott Chacon &lt;schacon@gmail.com&gt;
Date:   Wed Mar 10 07:34:10 2010 -0800

    second commit

commit b1ec3248f39900d2a406049d762aa68e9641be25
Author: Scott Chacon &lt;schacon@gmail.com&gt;
Date:   Wed Mar 10 07:34:01 2010 -0800

    first commit</code></pre>
</div>
</div>
<div class="paragraph">
<p>Якщо ви бажаєте відправити цей репозиторій комусь, проте не маєте туди доступу на запис, або просто не бажаєте налаштовувати доступ, ви можете спакувати його за допомогою <code>git bundle create</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git bundle create repo.bundle HEAD master
Counting objects: 6, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (2/2), done.
Writing objects: 100% (6/6), 441 bytes, done.
Total 6 (delta 0), reused 0 (delta 0)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Тепер у вас є файл <code>repo.bundle</code>, що містить всі необхідні для відтворення гілки <code>master</code> дані.
Вам необхідно надати команді <code>bundle</code> кожне посилання або низку комітів, які ви бажаєте включити.
Якщо ви збираєтесь таким чином створювати клон, то маєте також додати до посилань HEAD, як ми тут зробили.</p>
</div>
<div class="paragraph">
<p>Ви можете відправити файл <code>repo.bundle</code> електронною поштою комусь, або скопіювати його на USB накопичувач та віднести кудись.</p>
</div>
<div class="paragraph">
<p>З іншого боку, припустимо, що вам надіслали цей файл <code>repo.bundle</code>, та ви бажаєте попрацювати над проектом.
Ви можете створити клон з цього двійкового файлу в директорію, ніби з URL.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git clone repo.bundle repo
Cloning into 'repo'...
...
$ cd repo
$ git log --oneline
9a466c5 second commit
b1ec324 first commit</code></pre>
</div>
</div>
<div class="paragraph">
<p>Якщо ви не включили HEAD до посилань, то маєте також додати опцію <code>-b master</code> чи будь-яку включену гілку, адже інакше Git не знатиме на яку гілку переключатись.</p>
</div>
<div class="paragraph">
<p>Тепер, припустімо, що ви створюєте три коміти у цій гілці та бажаєте відправити нові коміти назад за допомогою пакунку через електронну пошту або за допомогою USB накопичувача.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git log --oneline
71b84da last commit - second repo
c99cf5b fourth commit - second repo
7011d3d third commit - second repo
9a466c5 second commit
b1ec324 first commit</code></pre>
</div>
</div>
<div class="paragraph">
<p>Спочатку треба визначити, які саме коміти ми бажаємо включити в пакунок.
На відміну від мережевих протоколів, які самі можуть знайти мінімальний набір даних для передачі через мережу, нам доведеться це зробити самотужки.
Тепер, ви могли би просто зробити те саме та запакувати весь репозиторій, і це спрацює, проте краще спакувати лише різницю - лише три коміти, які ми щойно створили локально.</p>
</div>
<div class="paragraph">
<p>Щоб це зробити, вам треба обчислити різницю.
Як було описано в <a href="{{< relurl "book/uk/v2/ch00/_commit_ranges" >}}">Інтервали комітів</a>, ви можете задати низку комітів безліччю методів.
Щоб отримати три коміти, які є в гілці master, проте їх немає в гілці, з якої ми зробили клон, ми можемо використати щось подібне до <code>origin/master..master</code> або <code>master ^origin/master</code>.
Ви можете перевірити це за допомогою команди <code>log</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git log --oneline master ^origin/master
71b84da last commit - second repo
c99cf5b fourth commit - second repo
7011d3d third commit - second repo</code></pre>
</div>
</div>
<div class="paragraph">
<p>Отже тепер, коли в нас є список комітів, які ми бажаємо включити в пакунок, спакуймо їх.
Це робиться за допомогою команди <code>git bundle create</code>, їй треба передати назву файлу, в якому буде створено пакунок, та низку комітів, які мають до нього увійти.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git bundle create commits.bundle master ^9a466c5
Counting objects: 11, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (3/3), done.
Writing objects: 100% (9/9), 775 bytes, done.
Total 9 (delta 0), reused 0 (delta 0)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Тепер в нашій директорії є файл <code>commits.bundle</code>.
Якщо відправити його нашій співробітниці, то вона зможе імпортувати його до оригінального репозиторія, навіть якщо там теж було щось зроблено за цей час.</p>
</div>
<div class="paragraph">
<p>Коли вона отримує пакунок, то може дослідити його зміст до того, як імпортувати його до репозиторія.
Спершу варто скористатись командою <code>bundle verify</code>, яка пересвідчиться, що файл дійсно є правильним пакунком Git, та у вас є всі необхідні для його правильного відновлення предки.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git bundle verify ../commits.bundle
The bundle contains 1 ref
71b84daaf49abed142a373b6e5c59a22dc6560dc refs/heads/master
The bundle requires these 1 ref
9a466c572fe88b195efd356c3f2bbeccdb504102 second commit
../commits.bundle is okay</code></pre>
</div>
</div>
<div class="paragraph">
<p>Якби б пакувальник створив пакунок, що містить лише два останні коміти, а не всі три, то оригінальний репозиторій був би не в змозі імпортувати його, адже в ньому бракує необхідної історії.
Команда <code>verify</code> виглядала би натомість так:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git bundle verify ../commits-bad.bundle
error: Repository lacks these prerequisite commits:
error: 7011d3d8fc200abe0ad561c011c3852a4b7bbe95 third commit - second repo</code></pre>
</div>
</div>
<div class="paragraph">
<p>Втім, наш перший пакунок правильний, отже ми можемо отримати з нього коміти.
Якщо ви бажаєте дізнатись, які гілки є в пакунку та можуть бути імпортовані, існує також команда, що просто виводить список голів (heads):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git bundle list-heads ../commits.bundle
71b84daaf49abed142a373b6e5c59a22dc6560dc refs/heads/master</code></pre>
</div>
</div>
<div class="paragraph">
<p>Підкоманда <code>verify</code> також розкаже вам про голови.
Суть в тому, щоб побачити, що можна отримати, щоб ви могли використати команди <code>fetch</code> чи <code>pull</code>, щоб імпортувати коміти з пакунку.
Тут ми отримаємо гілку <code>master</code> з пакунку в гілку нашого репозиторія під назвою <code>other-master</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git fetch ../commits.bundle master:other-master
From ../commits.bundle
 * [new branch]      master     -&gt; other-master</code></pre>
</div>
</div>
<div class="paragraph">
<p>Тепер ми бачимо, що імпортовані коміти є в гілці <em>other-master</em>, а також усі зроблені нами тим часом коміти в нашій власній гілці <em>master</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git log --oneline --decorate --graph --all
* 8255d41 (HEAD, master) third commit - first repo
| * 71b84da (other-master) last commit - second repo
| * c99cf5b fourth commit - second repo
| * 7011d3d third commit - second repo
|/
* 9a466c5 second commit
* b1ec324 first commit</code></pre>
</div>
</div>
<div class="paragraph">
<p>Отже, <code>git bundle</code> може бути дійсно корисним, щоб надати комусь зміни або робити мережеві операції, коли у вас немає відповідної мережі або спільного репозиторія, щоб це робити.</p>
</div>
<div id="nav"><a href="{{< previous-section >}}">prev</a> | <a href="{{< next-section >}}">next</a></div>