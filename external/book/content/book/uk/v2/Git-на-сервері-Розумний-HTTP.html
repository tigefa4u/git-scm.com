---
### DO NOT EDIT! Generated by script/update-book2.rb
category: book
section: documentation
subsection: book
sidebar: book
book:
  language_code: uk
  chapter:
    title: Git на сервері
    number: 4
  section:
    title: Розумний HTTP
    number: 6
    cs_number: '4.6'
    previous: book/uk/v2/Git-на-сервері-Демон-Git
    next: book/uk/v2/Git-на-сервері-GitWeb
title: Git - Розумний HTTP
url: "/book/uk/v2/Git-на-сервері-Розумний-HTTP.html"
---
<h2 id="_розумний_http_2">Розумний HTTP</h2>
<div class="paragraph">
<p>
Ми вже маємо авторизований доступ через SSH та неавторизований через <code>git://</code>, проте існує ще протокол, котрий може працювати в обох варіантах одночасно.
Налаштування Розумного HTTP потрибує лише ввімкнути CGI скрипт, що входить в пакет Git під назвою <code>git-http-backent</code>, на вашому сервері.
Цей CGI буде читати шлях та заголовки, що їх відправили <code>git fetch</code> чи <code>git push</code> до HTTP URL та визначати, чи клієнт в змозі спілкуватися через HTTP (що є правдою для будь-якого клієнту після версії 1.6.6).
Якщо CGI визначив, що клієнт розумний, він буде з ним спілкуватися розумно, інакше доведеться використовувати тупу поведінку (отже він зворотно сумісний для читання зі старіших клієнтів).</p>
</div>
<div class="paragraph">
<p>Давайте покроково розглянемо дуже просту схему налаштування.
Ми використаємо Apache в якості CGI серверу.
Якщо у вас немає Apache, ви можете його встановити на Linux машині приблизно так:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ sudo apt-get install apache2 apache2-utils
$ a2enmod cgi alias env</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ця команда також вмикає модулі <code>mod_cgi</code>, <code>mod_alias</code> і <code>mod_env</code>. Вони всі необхідні для правильної роботи розумного HTTP.</p>
</div>
<div class="paragraph">
<p>Вам також треба встановити групу Unix теки <code>/srv/git</code> у значення <code>www-data</code>, щоб веб сервер мав доступ на читання й запис до сховища, оскільки процес APache, що виконує CGI скрипт, буде типово виконуватись від цього користувача:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ chgrp -R www-data /srv/git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Далі нам треба додати дещо до конфігурації Apache, щоб <code>git-http-backend</code> обробник для будь-якого шляху на вашому веб сервері, що закінчується на <code>/git</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">SetEnv GIT_PROJECT_ROOT /srv/git
SetEnv GIT_HTTP_EXPORT_ALL
ScriptAlias /git/ /usr/lib/git-core/git-http-backend/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Якщо ви пропустите змінну середовища <code>GIT_HTTP_EXPORT_ALL, Git погодиться роздавати неавторизованим користувачам тільки сховища з файлом `git-daemon-export-ok</code>, як робить і демон Git.</p>
</div>
<div class="paragraph">
<p>Нарешті, вам варто сказати Apache дозволяти запити до <code>git-http-backend</code> і якимось чином зробити записи авторизованими, можливо за допомогою блоку Auth ось так:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">&lt;Files "git-http-backend"&gt;
    AuthType Basic
    AuthName "Git Access"
    AuthUserFile /srv/git/.htpasswd
    Require expr !(%{QUERY_STRING} -strmatch '*service=git-receive-pack*' || %{REQUEST_URI} =~ m#/git-receive-pack$#)
    Require valid-user
&lt;/Files&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Щоб це працювало необхідно створити файл <code>.htpasswd</code> з паролями дозволених користувачів.
Ось приклад того, як можна додати користувача “schacon” до цього файлу:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ htpasswd -c /srv/git/.htpasswd schacon</code></pre>
</div>
</div>
<div class="paragraph">
<p>Існує безліч методів авторизації в Apache, вам доведеться вибрати та використати один з них.
У цій секції ми навели найпростіший приклад, який тільки могли вигадати.
Також ви безсумнівно захочете налаштувати шифрування даних через SSL.</p>
</div>
<div class="paragraph">
<p>Ми не бажаємо занадто багато розглядати конфігурацію Apache, адже цілком можливо, що ви будете використовувати інший сервер, чи у вас інші потреби авторизації.
Суть в тому, що Git поставляє CGI скрипт <code>git-http-backent</code>, який може відправляти та приймати дані Git через HTTP.
Він не реалізує авторизацію сам, проте авторизацію легко контролювати на рівні веб серверу, що його викликає.
Це дозволяє майже кожен веб сервер, що підтримує CGI, отже використовуйте той, що ви найкраще знаєте.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Зауваження</div>
</td>
<td class="content">
<div class="paragraph">
<p>За докладнішою інформацією щодо конфігурації авторизації в Apache, дивіться документацію Apache за адресою: <a href="http://httpd.apache.org/docs/current/howto/auth.html" class="bare">http://httpd.apache.org/docs/current/howto/auth.html</a></p>
</div>
</td>
</tr>
</table>
</div>
<div id="nav"><a href="{{< previous-section >}}">prev</a> | <a href="{{< next-section >}}">next</a></div>