---
### DO NOT EDIT! Generated by script/update-book2.rb
category: book
section: documentation
subsection: book
sidebar: book
book:
  language_code: es
  chapter:
    title: Git en el Servidor
    number: 4
  section:
    title: El demonio Git
    number: 5
    cs_number: '4.5'
    previous: book/es/v2/Git-en-el-Servidor-Configurando-el-servidor
    next: book/es/v2/Git-en-el-Servidor-HTTP-Inteligente
title: Git - El demonio Git
---
<h2 id="_el_demonio_git">El demonio Git</h2>
<div class="paragraph">
<p>
Ahora vamos a configurar un “demonio” sirviendo repositorios mediante el
protocolo “Git”. Es la forma más común para dar acceso anónimo,
pero rápido, a los repositorios. Recuerda: puesto que es un acceso
no autentificado, todo lo que sirvas mediante este protocolo será
público en la red.</p>
</div>
<div class="paragraph">
<p>Si activas el protocolo en un servidor más allá del cortafuegos, lo debes
usar únicamente en proyectos que deban ser visibles a todo el mundo. Si
el servidor está detrás de un cortafuegos, puedes usarlo en proyectos a los
que un gran número de personas o de computadores (por ejemplo, servidores de
integración continua o de compilación) tengan acceso de sólo lectura y no
necesiten establecer una clave SSH para cada uno de ellos.</p>
</div>
<div class="paragraph">
<p>El protocolo Git es relativamente fácil de configurar. Básicamente, necesitas
ejecutar el comando con la variante “demonio” (daemon):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">git daemon --reuseaddr --base-path=/opt/git/ /opt/git/</code></pre>
</div>
</div>
<div class="paragraph">
<p>El parámetro <code>--reuseaddr</code> permite al servidor reiniciarse sin esperar
a que se liberen viejas conexiones; el parámetro <code>--base-path</code> permite a los
usuarios clonar proyectos sin necesidad de indicar su camino completo; y el
camino indicado al final del comando mostrará al “demonio” Git, dónde buscar los
repositorios a exportar. Si tienes un cortafuegos activo, necesitarás abrir
el puerto 9418 para la máquina donde estás configurando el “demonio” Git.</p>
</div>
<div class="paragraph">
<p>Este proceso se puede demonizar de diferentes maneras, dependiendo del sistema
operativo con el que trabajas. En una máquina Ubuntu, puedes usar un script
de arranque. Poniendo en el siguiente archivo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">/etc/event.d/local-git-daemon</code></pre>
</div>
</div>
<div class="paragraph">
<p>un script tal como:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">start on startup
stop on shutdown
exec /usr/bin/git daemon \
    --user=git --group=git \
    --reuseaddr \
    --base-path=/opt/git/ \
    /opt/git/
respawn</code></pre>
</div>
</div>
<div class="paragraph">
<p>Por razones de seguridad, es recomendable lanzar este “demonio” con un usuario
que tenga únicamente permisos de lectura en los repositorios (Lo puedes hacer
creando un nuevo usuario <em>git-ro</em> y lanzando el “demonio” con él). Para
simplificar, en estos ejemplos vamos a lanzar el “demonio” Git bajo el mismo
usuario <code>git</code> que se usa con <code>git-shell</code>.</p>
</div>
<div class="paragraph">
<p>Tras reiniciar tu máquina, el “demonio” Git arrancará automáticamente y se
reiniciará cuando se caiga. Para arrancarlo sin necesidad de reiniciar la
máquina, puedes utilizar el comando:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">initctl start local-git-daemon</code></pre>
</div>
</div>
<div class="paragraph">
<p>En otros sistemas operativos, puedes utilizar <code>xinetd</code>, un script en el
sistema <code>sysvinit</code>, o alguna otra manera (siempre y cuando demonizes el comando
y puedas monitorizarlo).</p>
</div>
<div class="paragraph">
<p>A continuación, has de indicar a Git a cuales de tus repositorios ha de permitir
acceso sin autentificar. Lo puedes hacer creando en cada repositorio un archivo
llamado <code>git-daemon-export-ok</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cd /path/to/project.git
$ touch git-daemon-export-ok</code></pre>
</div>
</div>
<div class="paragraph">
<p>La presencia de este archivo dice a Git que este proyecto se puede servir sin problema
sin necesidad de autentificación de usuarios.</p>
</div>
<div id="nav"><a href="{{< previous-section >}}">prev</a> | <a href="{{< next-section >}}">next</a></div>