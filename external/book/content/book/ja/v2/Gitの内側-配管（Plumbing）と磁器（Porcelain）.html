---
### DO NOT EDIT! Generated by script/update-book2.rb
category: book
section: documentation
subsection: book
sidebar: book
book:
  language_code: ja
  chapter:
    title: Gitの内側
    number: 10
  section:
    title: 配管（Plumbing）と磁器（Porcelain）
    number: 1
    cs_number: '10.1'
    previous: book/ja/v2/Gitとその他のシステムの連携-まとめ
    next: book/ja/v2/Gitの内側-Gitオブジェクト
title: Git - 配管（Plumbing）と磁器（Porcelain）
url: "/book/ja/v2/Gitの内側-配管（Plumbing）と磁器（Porcelain）.html"
---
<p>どこかの章からここに飛んできたのか、本書の他の部分を読み終えてからここにたどり着いたのか – いずれにせよ、この章ではGitの内部動作と実装を詳細に見ていきます。
我々は、Gitがいかに便利で強力かを理解するには、その内部動作と実装を学ぶことが根本的に重要であると考えました。一方で、そういった内容は、初心者にとっては不必要に複雑で、かえって混乱を招くおそれがあると主張する人もいました。
そこで我々は、この話題を本書の最後の章にして、読者の学習プロセスの最初の方で読んでも最後の方で読んでもいいようにしました。
いつ読むかって？　それは読者の判断にお任せします。</p><p>もう既にあなたはこの章を読んでいますので、早速、開始しましょう。
まず最初に明確にしておきたいのですが、Gitの実態は内容アドレスファイルシステム（content-addressable filesystem）であり、その上にVCSのユーザーインターフェイスが実装されています。
これが何を意味するかについては、すぐ後で学びます。</p><p>初期（主に1.5より古いバージョン）のGitのユーザーインターフェイスは、今よりずっと複雑でした。これは、当時のGitが、洗練されたVCSであることよりも、このファイルシステムの方を重要視していたためです。
ここ数年で、Gitのユーザーインターフェイスは改良されて、世の中にある他のシステムと同じくらいシンプルで扱いやすいものになりました。しかし、複雑で学習するのが難しいという、初期のGitのUIに対するステレオタイプはいまだに残っています。</p><p>内容アドレスファイルシステムの層は驚くほど素晴らしいので、この章の最初で取り上げます。その次に転送メカニズムと、今後あなたが行う必要があるかもしれないリポジトリの保守作業について学習することにします。</p>
<h2 id="r_plumbing_porcelain">配管（Plumbing）と磁器（Porcelain）</h2>
<div class="paragraph">
<p>本書では、<code>checkout</code> や <code>branch</code>、<code>remote</code> などの約30のコマンドを用いて、Gitの使い方を説明しています。
一方、Gitには低レベルの処理を行うためのコマンドも沢山あります。これは、Gitが元々は、完全にユーザフレンドリーなVCSというよりも、VCSのためのツールキットだったことが理由です。これらのコマンドは、UNIX流につなぎ合わせたり、スクリプトから呼んだりすることを主眼において設計されています。
これらのコマンドは、通常 “配管（plumbing）” コマンドと呼ばれています。対して、よりユーザフレンドリーなコマンドは “磁器（porcelain）” コマンドと呼ばれています。</p>
</div>
<div class="paragraph">
<p>本書のはじめの9つの章では、ほぼ磁器コマンドだけを取り扱ってきました。
一方、本章ではそのほとんどで低レベルの配管コマンドを使用します。これは、Gitの内部動作にアクセスして、Gitが、ある処理を、なぜ、どうやって行うのか確かめるためです。
これら配管コマンドの多くは、コマンドラインから直接実行されるのではなく、新しくツールやカスタムスクリプトを作る際に構成要素となることを意図して作られています。</p>
</div>
<div class="paragraph">
<p>新規の、または既存のディレクトリで <code>git init</code> を実行すると、Git は <code>.git</code> というディレクトリを作ります。Git が保管したり操作したりする対象の、ほとんどすべてがここに格納されます。
リポジトリのバックアップやクローンをしたい場合、このディレクトリをどこかへコピーするだけで、ほぼ事足ります。
基本的にこの章では、全体を通して、 <code>.git</code> ディレクトリの内容を取り扱います。
<code>.git</code> ディレクトリの中は以下のようになっています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ls -F1
HEAD
config*
description
hooks/
info/
objects/
refs/</code></pre>
</div>
</div>
<div class="paragraph">
<p>これが <code>git init</code> を実行した直後のデフォルトのリポジトリであり、デフォルトで表示される内容です。なお、環境によってはここにないファイルが表示されることもあります。
<code>description</code> ファイルは、GitWebプログラムでのみ使用するものなので、特に気にしなくて大丈夫です。
<code>config</code> ファイルには、プロジェクト固有の設定が書かれています。また、<code>info</code> ディレクトリにはグローバルレベルの除外設定ファイル  が格納されます。これは、.gitignoreファイルに記録したくない除外パターンを書く際に使用します。
<code>hooks</code> ディレクトリには、クライアントサイド、または、サーバーサイドのフックスクリプトが格納されます。フックスクリプトについては <a href="{{< relurl "book/ja/v2/ch00/r_git_hooks" >}}">Git フック</a> で詳しく説明します。</p>
</div>
<div class="paragraph">
<p>そして、重要なのは残りの4項目です。具体的には、 <code>HEAD</code> ファイル、 <code>index</code> ファイル（まだ作成されていない）、 <code>objects</code> ディレクトリ、 <code>refs</code> ディレクトリです。
これらがGitの中核部分になります。
<code>objects</code> ディレクトリにはデータベースのすべてのコンテンツが保管されます。<code>refs</code> ディレクトリには、それらコンテンツ内のコミットオブジェクトを指すポインタ（ブランチ）が保管されます。<code>HEAD</code> ファイルは、現在チェックアウトしているブランチを指します。<code>index</code> ファイルには、Git がステージングエリアの情報を保管します。
以降の各セクションでは、Git がどのような仕組みで動くのかを詳細に見ていきます。</p>
</div>
<div id="nav"><a href="{{< previous-section >}}">prev</a> | <a href="{{< next-section >}}">next</a></div>