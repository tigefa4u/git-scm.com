---
### DO NOT EDIT! Generated by script/update-book2.rb
category: book
section: documentation
subsection: book
sidebar: book
book:
  language_code: ru
  chapter:
    title: Ветвление в Git
    number: 3
  section:
    title: Управление ветками
    number: 3
    cs_number: '3.3'
    previous: book/ru/v2/Ветвление-в-Git-Основы-ветвления-и-слияния
    next: book/ru/v2/Ветвление-в-Git-Работа-с-ветками
title: Git - Управление ветками
url: "/book/ru/v2/Ветвление-в-Git-Управление-ветками.html"
---
<h2 id="r_branch_management">Управление ветками</h2>
<div class="paragraph">
<p>
Теперь, когда вы уже попробовали создавать, объединять и удалять ветки, пора познакомиться с некоторыми инструментами для управления ветками, которые вам пригодятся, когда вы начнёте использовать ветки постоянно.</p>
</div>
<div class="paragraph">
<p>Команда <code>git branch</code> делает несколько больше, чем просто создаёт и удаляет ветки.
При запуске без параметров, вы получите простой список имеющихся у вас веток:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git branch
  iss53
* master
  testing</code></pre>
</div>
</div>
<div class="paragraph">
<p>Обратите внимание на символ <code>*</code>, стоящий перед веткой <code>master</code>: он указывает на ветку, на которой вы находитесь в настоящий момент (т. е. ветку, на которую указывает <code>HEAD</code>).
Это означает, что если вы сейчас сделаете коммит, ветка <code>master</code> переместится вперёд в соответствии с вашими последними изменениями.
Чтобы посмотреть последний коммит на каждой из веток, выполните команду <code>git branch -v</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git branch -v
  iss53   93b412c Fix javascript issue
* master  7a98805 Merge branch 'iss53'
  testing 782fd34 Add scott to the author list in the readme</code></pre>
</div>
</div>
<div class="paragraph">
<p>Опции <code>--merged</code> и <code>--no-merged</code> могут отфильтровать этот список для вывода только тех веток, которые слиты или ещё не слиты в текущую ветку.
Чтобы посмотреть те ветки, которые вы уже слили с текущей, можете выполнить команду <code>git branch --merged</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git branch --merged
  iss53
* master</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ветка <code>iss53</code> присутствует в этом списке потому что вы ранее слили её в <code>master</code>.
Те ветки из этого списка, перед которыми нет символа <code>*</code>, можно смело удалять командой <code>git branch -d</code>; наработки из этих веток уже включены в другую ветку, так что ничего не потеряется.</p>
</div>
<div class="paragraph">
<p>Чтобы увидеть все ветки, содержащие наработки, которые вы пока ещё не слили в текущую ветку, выполните команду <code>git branch --no-merged</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git branch --no-merged
  testing</code></pre>
</div>
</div>
<div class="paragraph">
<p>Вы увидите оставшуюся ветку.
Так как она содержит ещё не слитые наработки, попытка удалить её командой <code>git branch -d</code> приведёт к ошибке:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git branch -d testing
error: The branch 'testing' is not fully merged.
If you are sure you want to delete it, run 'git branch -D testing'.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если вы действительно хотите удалить ветку вместе со всеми наработками, используйте опцию <code>-D</code>, как указано в подсказке.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Подсказка</div>
</td>
<td class="content">
<div class="paragraph">
<p>Если в качестве аргумента не указан коммит или ветка, то опции <code>--merged</code> и <code>--no-merged</code> покажут что уже слито или не слито с вашей <em>текущей</em> веткой соответственно.</p>
</div>
<div class="paragraph">
<p>Вы всегда можете указать дополнительный аргумент для вывода той же информации, но относительно указанной ветки предварительно не извлекая и не переходя на неё.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git checkout testing
$ git branch --no-merged master
  topicA
  featureB</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h3 id="_переименование_ветки">Переименование ветки</h3>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Внимание</div>
</td>
<td class="content">
<div class="paragraph">
<p>Не переименовывайте ветки, которые всё ещё используются другими участниками.
Не переименовывайте ветку в master/main/mainline, не прочитав раздел «Изменение имени главной ветки».</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Предположим, у вас есть ветка с именем <code>bad-branch-name</code>, и вы хотите изменить её на <code>corrected-branch-name</code>, сохранив при этом всю историю.
Вместе с этим, вы также хотите изменить имя ветки на удалённом сервере (GitHub, GitLab или другой сервер).
Как это сделать?</p>
</div>
<div class="paragraph">
<p>Переименуйте ветку локально с помощью команды <code>git branch --move</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git branch --move bad-branch-name corrected-branch-name</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ветка <code>bad-branch-name</code> будет переименована в <code>corrected-branch-name</code>, но это изменение пока только локальное.
Чтобы все остальные увидели исправленную ветку в удалённом репозитории, отправьте её туда:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git push --set-upstream origin corrected-branch-name</code></pre>
</div>
</div>
<div class="paragraph">
<p>Теперь проверим, где мы сейчас находимся:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git branch --all
* corrected-branch-name
  main
  remotes/origin/bad-branch-name
  remotes/origin/corrected-branch-name
  remotes/origin/main</code></pre>
</div>
</div>
<div class="paragraph">
<p>Обратите внимание, что текущая ветка <code>corrected-branch-name</code>, которая также присутствует и на удалённом сервере.
Однако, старая ветка всё ещё по-прежнему там, но её можно удалить с помощью команды:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git push origin --delete bad-branch-name</code></pre>
</div>
</div>
<div class="paragraph">
<p>Теперь старое имя ветки полностью заменено исправленным.</p>
</div>
<div class="sect4">
<h4 id="_изменение_имени_главной_ветки">Изменение имени главной ветки</h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Предупреждение</div>
</td>
<td class="content">
<div class="paragraph">
<p>Изменение имени ветки, например master/main/mainline/default, сломает интеграции, службы, вспомогательные утилиты и скрипты сборки, которые использует ваш репозиторий.
Прежде чем сделать это, обязательно проконсультируйтесь с коллегами.
Также убедитесь, что вы выполнили тщательный поиск в своём репозитории и обновили все ссылки на старое имя ветки в вашем коде или скриптах.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Переименуйте локальную ветку <code>master</code> в <code>main</code> с помощью следующей команды:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git branch --move master main</code></pre>
</div>
</div>
<div class="paragraph">
<p>После этого, локальной ветки <code>master</code> больше не существует, потому что она была переименована в ветку <code>main</code>.</p>
</div>
<div class="paragraph">
<p>Чтобы все остальные могли видеть новую ветку <code>main</code>, вам нужно отправить её в общий репозиторий.
Это делает переименованную ветку доступной в удалённом репозитории.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git push --set-upstream origin main</code></pre>
</div>
</div>
<div class="paragraph">
<p>В итоге, состояние репозитория становится следующим:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git branch --all
* main
  remotes/origin/HEAD -&gt; origin/master
  remotes/origin/main
  remotes/origin/master</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ваша локальная ветка <code>master</code> исчезла, так как она заменена веткой <code>main</code>.
Ветка <code>main</code> доступна в удалённом репозитории.
Старая ветка <code>master</code> всё ещё присутствует в удалённом репозитории.
Остальные участники будут продолжать использовать ветку <code>master</code> в качестве основы для своей работы, пока вы не совершите ряд дополнительных действий.</p>
</div>
<div class="paragraph">
<p>Теперь, для завершения перехода на новую ветку перед вами стоят следующие задачи:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Все проекты, которые зависят от текущего, должны будут обновить свой код и/или конфигурацию.</p>
</li>
<li>
<p>Обновите конфигурацию всех запускаемых тестов.</p>
</li>
<li>
<p>Исправьте скрипты сборки и публикации артефактов.</p>
</li>
<li>
<p>Поправьте настройки репозитория на сервере: задайте новую ветку по умолчанию, обновите правила слияния, а также прочие настройки, которые зависят от имени веток.</p>
</li>
<li>
<p>Обновите документацию, исправив ссылки, указывающие на старую ветку.</p>
</li>
<li>
<p>Слейте или отмените запросы на слияние изменений, нацеленные на старую ветку.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>После того, как вы выполнили все эти задачи и уверены, что ветка <code>main</code> работает так же, как ветка <code>master</code>, вы можете удалить ветку <code>master</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git push origin --delete master</code></pre>
</div>
</div>
</div>
</div>
<div id="nav"><a href="{{< previous-section >}}">prev</a> | <a href="{{< next-section >}}">next</a></div>