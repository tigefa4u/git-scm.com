---
### DO NOT EDIT! Generated by script/update-book2.rb
category: book
section: documentation
subsection: book
sidebar: book
book:
  language_code: ru
  chapter:
    title: Git на сервере
    number: 4
  section:
    title: Установка Git на сервер
    number: 2
    cs_number: '4.2'
    previous: book/ru/v2/Git-на-сервере-Протоколы
    next: book/ru/v2/Git-на-сервере-Генерация-открытого-SSH-ключа
title: Git - Установка Git на сервер
url: "/book/ru/v2/Git-на-сервере-Установка-Git-на-сервер.html"
---
<h2 id="r_git_on_the_server">Установка Git на сервер</h2>
<div class="paragraph">
<p>Рассмотрим теперь установку сервиса Git с поддержкой этих протоколов на сервер.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Примечание</div>
</td>
<td class="content">
<div class="paragraph">
<p>Здесь мы приводим команды и шаги, необходимые для базовой, упрощённой установки на Linux-сервер, но эти сервисы можно запустить и на MacOS или Windows сервере.
На самом деле, установка боевого сервера в вашей инфраструктуре неминуемо будет иметь отличия в настройках безопасности или инструментах операционной системы, но мы надеемся дать вам общее понимание происходящего.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Для того чтобы приступить к установке любого сервера Git, вы должны экспортировать существующий репозиторий в новый голый репозиторий — репозиторий без рабочего каталога.
Делается это просто.
Чтобы создать новый голый репозиторий — во время клонирования используйте параметр <code>--bare</code>.
По существующему соглашению, каталоги с голыми репозиториями заканчиваются на <code>.git</code>, например:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git clone --bare my_project my_project.git
Cloning into bare repository 'my_project.git'...
done.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Теперь у вас должна быть копия данных из каталога Git в каталоге <code>my_project.git</code>.</p>
</div>
<div class="paragraph">
<p>Грубо говоря, это эквивалентно команде:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cp -Rf my_project/.git my_project.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Тут есть пара небольших различий в файле конфигурации, но в нашем случае эту разницу можно считать несущественной.
В этом случае берётся репозиторий Git без рабочего каталога и помещается в отдельный каталог.</p>
</div>
<div class="sect3">
<h3 id="r_bare_repo">Размещение голого репозитория на сервере</h3>
<div class="paragraph">
<p>Теперь, когда у вас есть голая копия вашего репозитория, осталось поместить её на сервер и настроить протоколы.
Предположим, что вы уже настроили сервер <code>git.example.com</code>, имеете к нему доступ по SSH и хотите разместить все ваши репозитории Git в каталоге <code>/srv/git</code>.
Считая, что <code>/srv/git</code> уже есть на сервере, вы можете добавить ваш новый репозиторий копированием голого репозитория:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ scp -r my_project.git user@git.example.com:/srv/git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Теперь другие пользователи, имеющие доступ к серверу по SSH и права на чтение каталога <code>/srv/git</code>, могут клонировать ваш репозиторий выполнив команду:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git clone user@git.example.com:/srv/git/my_project.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если у пользователя есть права записи в каталог <code>/srv/git/my_project.git</code>, он автоматически получает возможность отправки изменений в репозиторий.</p>
</div>
<div class="paragraph">
<p>Git автоматически добавит права на запись в репозиторий для группы при запуске команды <code>git init</code> с параметром <code>--shared</code>.
Следует отметить, что при запуске этой команды коммиты, ссылки и прочее удалены не будут.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ssh user@git.example.com
$ cd /srv/git/my_project.git
$ git init --bare --shared</code></pre>
</div>
</div>
<div class="paragraph">
<p>Видите, как это просто, взять репозиторий Git, создать голую версию и поместить её на сервер, к которому вы и ваши коллеги имеете доступ по SSH.
Теперь вы готовы работать вместе над одним проектом.</p>
</div>
<div class="paragraph">
<p>Важно отметить, что это практически всё, что вам нужно сделать, чтобы получить рабочий Git-сервер, к которому имеют доступ несколько человек — просто добавьте учетные записи с возможностью доступа по SSH на сервер и положите голый репозиторий в то место, к которому эти пользователи имеют доступ на чтение и запись.
И всё.</p>
</div>
<div class="paragraph">
<p>Из нескольких последующих разделов вы узнаете, как получить более сложные конфигурации.
В том числе как не создавать учётные записи для каждого пользователя, как сделать публичный доступ на чтение репозитория, как установить веб-интерфейс и др.
Однако, помните, что для совместной работы пары человек на закрытом проекте, всё что вам <em>нужно</em> ― это SSH-сервер и голый репозиторий.</p>
</div>
</div>
<div class="sect3">
<h3 id="_малые_установки">Малые установки</h3>
<div class="paragraph">
<p>Если вы небольшая компания или вы только пробуете использовать Git в вашей организации и у вас небольшое число разработчиков, то всё достаточно просто.
Один из наиболее сложных аспектов настройки сервера Git — это управление пользователями.
Если вы хотите, чтобы некоторые репозитории были доступны определённым пользователям только на чтение, а остальным на чтение и запись, то настроить доступ и привилегии будет несколько сложнее.</p>
</div>
<div class="sect4">
<h4 id="_ssh_доступ">SSH доступ</h4>
<div class="paragraph">
<p>
Если у вас уже есть сервер, к которому все ваши разработчики имеют доступ по SSH, проще всего разместить ваш первый репозиторий там, поскольку вам не нужно практически ничего делать (как мы уже обсудили в предыдущем разделе).
Если вы хотите более сложного управления правами доступа к вашим репозиториям, вы можете сделать это обычными правами файловой системы, предоставляемыми операционной системой вашего сервера.</p>
</div>
<div class="paragraph">
<p>Если вы хотите разместить ваши репозитории на сервере, где нет учётных записей для членов команды, которым требуются права на запись, то вы должны настроить доступ по SSH для них.
Будем считать, что если у вас для этого есть сервер, то SSH-сервер на нём уже установлен и через него вы получаете доступ.</p>
</div>
<div class="paragraph">
<p>Есть несколько способов предоставить доступ всем участникам вашей команды.
Первый — создать учётные записи для каждого, это просто, но может быть весьма обременительно.
Вероятно, вы не захотите для каждого пользователя выполнять <code>adduser</code> (или <code>useradd</code>) и задавать временные пароли.</p>
</div>
<div class="paragraph">
<p>Второй способ — это создать на сервере пользователя <code>git</code>, попросить всех участников, кому требуется доступ на запись, прислать вам открытый ключ SSH и добавить эти ключи в файл <code>~/.ssh/authorized_keys</code> в домашнем каталоге пользователя <code>git</code>.
Теперь все будут иметь доступ к этой машине используя пользователя <code>git</code>.
Это никак не повлияет на данные в коммите — пользователь, под которым вы соединяетесь с сервером по SSH, не воздействует на созданные вами коммиты.</p>
</div>
<div class="paragraph">
<p>Другой способ сделать это — настроить SSH сервер на использование аутентификации через LDAP-сервер или любой другой имеющийся у вас централизованный сервер аутентификации.
Вы можете использовать любой механизм аутентификации на сервере и считать что он будет работать для Git, если пользователь может получить доступ к консоли по SSH.</p>
</div>
</div>
</div>
<div id="nav"><a href="{{< previous-section >}}">prev</a> | <a href="{{< next-section >}}">next</a></div>