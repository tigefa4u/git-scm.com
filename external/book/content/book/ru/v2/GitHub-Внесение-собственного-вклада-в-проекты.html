---
### DO NOT EDIT! Generated by script/update-book2.rb
category: book
section: documentation
subsection: book
sidebar: book
book:
  language_code: ru
  chapter:
    title: GitHub
    number: 6
  section:
    title: Внесение собственного вклада в проекты
    number: 2
    cs_number: '6.2'
    previous: book/ru/v2/GitHub-Настройка-и-конфигурация-учётной-записи
    next: book/ru/v2/GitHub-Сопровождение-проекта
title: Git - Внесение собственного вклада в проекты
url: "/book/ru/v2/GitHub-Внесение-собственного-вклада-в-проекты.html"
---
<h2 id="_внесение_собственного_вклада_в_проекты">Внесение собственного вклада в проекты</h2>
<div class="paragraph">
<p>Теперь наша учётная запись создана и настроена, давайте же пройдёмся по деталям, которые будут полезны при внесении вклада в уже существующие проекты.</p>
</div>
<div class="sect3">
<h3 id="_создание_ответвлений_fork">Создание ответвлений (fork)</h3>
<div class="paragraph">
<p>
Если вы хотите вносить свой вклад в уже существующие проекты, в которых у нас нет прав на внесения изменений путём отправки (push) изменений, вы можете создать своё собственное ответвление (fork) проекта.
Это означает, что GitHub создаст вашу собственную копию проекта, данная копия будет находиться в вашем пространстве имён и вы сможете легко делать изменения путём отправки (push) изменений.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Примечание</div>
</td>
<td class="content">
<div class="paragraph">
<p>Исторически так сложилось, что англоязычный термин «fork» (создание ветвления проекта) имел негативный контекстный смысл, данный термин означал, что кто-то повёл или ведёт проект с открытым исходным кодом в другом, отличном от оригинала, направлении, иногда данный термин так же означал создание конкурирующего проекта с раздельными авторами.
В контексте GitHub, «fork» (создание ветвления проекта) просто означает создание ветвления проекта в собственном пространстве имён, что позволяет вносить публичные изменения и делать свой собственный вклад в более открытом виде.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Таким образом, проекты не обеспокоены тем, чтобы пользователи, которые хотели бы выступать в роли соавторов, имели право на внесение изменений путём их отправки (push).
Люди просто могут создавать свои собственные ветвления (fork), вносить туда изменения, а затем отправлять свои внесённые изменения в оригинальный репозиторий проекта путём создания запроса на принятие изменений (Pull Request), сами же запросы на принятие изменений (Pull Request) будут описаны далее.
Запрос на принятие изменений (Pull Request) откроет новую ветвь с обсуждением отправляемого кода, и автор оригинального проекта, а так же другие его участники, могут принимать участие в обсуждении предлагаемых изменений до тех пор, пока автор проекта не будет ими доволен, после чего автор проекта может добавить предлагаемые изменения в проект.</p>
</div>
<div class="paragraph">
<p>Для того, чтобы создать ответвление проекта, зайдите на страницу проекта и нажмите кнопку «Создать ответвление» («Fork»), которая расположена в правом верхнем углу.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/forkbutton.png" >}}" alt="Кнопка «Создать ответвление» («Fork»)">
</div>
<div class="title">Рисунок 88. Кнопка «Создать ответвление» («Fork»)</div>
</div>
<div class="paragraph">
<p>Через несколько секунд вы будете перенаправлены на собственную новую проектную страницу, содержащую вашу копию, в которой у вас есть права на запись.</p>
</div>
</div>
<div class="sect3">
<h3 id="r_github_flow">Рабочий процесс с использованием GitHub</h3>
<div class="paragraph">
<p>
GitHub разработан с прицелом на определённый рабочий процесс с использованием запросов на слияния.
Этот рабочий процесс хорошо подходит всем: и маленьким, сплочённым вокруг одного репозитория, командам; и крупным распределённым компаниям, и группам незнакомцев, сотрудничающих над проектом с сотней копий.
Рабочий процесс GitHub основан на <a href="{{< relurl "book/ru/v2/ch00/r_topic_branch" >}}">тематических ветках</a>, о которых мы говорили в главе <a href="{{< relurl "book/ru/v2/ch00/ch03-git-branching" >}}">Ветвление в Git</a>.</p>
</div>
<div class="paragraph">
<p>Вот как это обычно работает:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Создайте форк проекта.</p>
</li>
<li>
<p>Создайте тематическую ветку на основании ветки <code>master</code>.</p>
</li>
<li>
<p>Создайте один или несколько коммитов с изменениями, улучшающих проект.</p>
</li>
<li>
<p>Отправьте эту ветку в ваш проект на GitHub.</p>
</li>
<li>
<p>Откройте запрос на слияние на GitHub.</p>
</li>
<li>
<p>Обсуждайте его, вносите изменения, если нужно.</p>
</li>
<li>
<p>Владелец проекта принимает решение о принятии изменений, либо об их отклонении.</p>
</li>
<li>
<p>Получите обновлённую ветку <code>master</code> и отправьте её в свой форк.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Очень напоминает подход, описанный в разделе <a href="{{< relurl "book/ru/v2/ch00/r_integration_manager" >}}">Диспетчер интеграции</a> главы 5, но вместо использования электронной почты, команда сотрудничает через веб-интерфейс.</p>
</div>
<div class="paragraph">
<p>Давайте посмотрим, как можно предложить изменения в проект, размещённый на GitHub.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Подсказка</div>
</td>
<td class="content">
<div class="paragraph">
<p>В большинстве случаев можно использовать официальный инструмент <strong>GitHub CLI</strong> вместо веб-интерфейса GitHub.
Инструмент доступен в системах Windows, MacOS и Linux.
Посетите страницу <a href="https://cli.github.com/" target="_blank" rel="noopener">GitHub CLI homepage</a> для получения инструкций по установке и использованию.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h4 id="_создание_запроса_на_слияние">Создание запроса на слияние</h4>
<div class="paragraph">
<p>Тони ищет, чего бы запустить на своём новеньком Arduino.
Кажется, он нашёл классный пример на <a href="https://github.com/schacon/blink" class="bare" target="_blank" rel="noopener">https://github.com/schacon/blink</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/blink-01-start.png" >}}" alt="Проект, над которым мы хотим поработать">
</div>
<div class="title">Рисунок 89. Проект, над которым мы хотим поработать</div>
</div>
<div class="paragraph">
<p>Единственная проблема в том, что светодиод моргает слишком быстро; нам кажется, лучше установить задержку в три секунды, не одну.
Так давайте исправим это и предложим изменения автору.</p>
</div>
<div class="paragraph">
<p>Для начала, нажмите кнопку «Fork», как было сказано выше, чтобы заполучить собственную копию проекта.
Мы зарегистрированы на GitHub под именем «tonychacon», так что наша копия окажется по адресу <code><a href="https://github.com/tonychacon/blink" class="bare">https://github.com/tonychacon/blink</a></code>, где мы сможем редактировать её.
Мы клонируем её, создадим тематическую ветку, внесём необходимые изменения и, наконец, отправим их на GitHub.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git clone https://github.com/tonychacon/blink <b class="conum">(1)</b>
Cloning into 'blink'...

$ cd blink
$ git checkout -b slow-blink <b class="conum">(2)</b>
Switched to a new branch 'slow-blink'

$ sed -i '' 's/1000/3000/' blink.ino (macOS) <b class="conum">(3)</b>
# If you're on a Linux system, do this instead:
# $ sed -i 's/1000/3000/' blink.ino <b class="conum">(3)</b>

$ git diff --word-diff <b class="conum">(4)</b>
diff --git a/blink.ino b/blink.ino
index 15b9911..a6cc5a5 100644
--- a/blink.ino
+++ b/blink.ino
@@ -18,7 +18,7 @@ void setup() {
// the loop routine runs over and over again forever:
void loop() {
  digitalWrite(led, HIGH);   // turn the LED on (HIGH is the voltage level)
  [-delay(1000);-]{+delay(3000);+}               // wait for a second
  digitalWrite(led, LOW);    // turn the LED off by making the voltage LOW
  [-delay(1000);-]{+delay(3000);+}               // wait for a second
}

$ git commit -a -m 'Change delay to 3 seconds' <b class="conum">(5)</b>
[slow-blink 5ca509d] Change delay to 3 seconds
 1 file changed, 2 insertions(+), 2 deletions(-)

$ git push origin slow-blink <b class="conum">(6)</b>
Username for 'https://github.com': tonychacon
Password for 'https://tonychacon@github.com':
Counting objects: 5, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 340 bytes | 0 bytes/s, done.
Total 3 (delta 1), reused 0 (delta 0)
To https://github.com/tonychacon/blink
 * [new branch]      slow-blink -&gt; slow-blink</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Клонируем нашу копию</p>
</li>
<li>
<p>Создаём тематическую ветку</p>
</li>
<li>
<p>Вносим свои изменения</p>
</li>
<li>
<p>Проверяем изменения</p>
</li>
<li>
<p>Фиксируем изменения в тематической ветку</p>
</li>
<li>
<p>Отправляем новую ветку в нашу копию на GitHub</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Теперь, если мы зайдём на страничку нашей копии на GitHub, мы увидим, что GitHub заметил наши изменения и предлагает открыть запрос на слияние с помощью большой зелёной кнопки.</p>
</div>
<div class="paragraph">
<p>Также можно зайти на страницу «Branches», по адресу <code>https://github.com/&lt;user&gt;/&lt;project&gt;/branches</code>, найти интересующую ветку и открыть запрос оттуда.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/blink-02-pr.png" >}}" alt="Кнопка открытия запроса на слияние">
</div>
<div class="title">Рисунок 90. Кнопка открытия запроса на слияние</div>
</div>
<div class="paragraph">
<p>
Если нажать на эту кнопку, появится экран ввода заголовка и описания предлагаемых изменений на рассмотрение владельцу проекта.
Рекомендуется серьёзно подойти к составлению описания и сделать его максимально информативным, чтобы владелец проекта понимал, зачем эти изменения и какую пользу они принесут.</p>
</div>
<div class="paragraph">
<p>Также мы видим список коммитов в нашей тематической ветке, «опередивших» ветку <code>master</code> (в данном случае всего один коммит) и предпросмотр всех изменений, вносимых этими коммитами.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/blink-03-pull-request-open.png" >}}" alt="Создание запроса на слияние">
</div>
<div class="title">Рисунок 91. Страница создания запроса на слияние</div>
</div>
<div class="paragraph">
<p>После создания запроса на слияние (путём нажатия кнопки «Create pull request» на этой странице) владелец форкнутого проекта получит уведомление о предложенных изменениях со ссылкой на страницу с информацией о запросе.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Примечание</div>
</td>
<td class="content">
<div class="paragraph">
<p>Запросы на слияние широко используются для публичных проектов типа описанного выше, когда участник уже подготовил все изменения для слияния с основным репозиторием.
Тем не менее, часто можно встретить использование запросов на слияние во внутренних проектах <em>в самом начале</em> цикла разработки.
Объяснение простое: вы можете обновлять тематическую ветку <strong>после</strong> открытия запроса на слияние, поэтому сам запрос открывается как можно раньше чтобы отслеживать прогресс разработки.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h4 id="_обработка_запроса_на_слияние">Обработка запроса на слияние</h4>
<div class="paragraph">
<p>На этом этапе, владелец проекта может просмотреть предложенные изменения, принять, отклонить или прокомментировать их.
Предположим, ему импонирует идея, но он предпочёл бы большую задержку перед включением или выключением света.</p>
</div>
<div class="paragraph">
<p>В то время как в главе <a href="{{< relurl "book/ru/v2/ch00/ch05-distributed-git" >}}">Распределённый Git</a> обсуждение изменений может производится через электронную почту, на GitHub всё происходит онлайн.
Владелец проекта может просмотреть суммарные изменения, вносимые запросом, и прокомментировать любую отдельно взятую строку.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/blink-04-pr-comment.png" >}}" alt="Комментирование строки в запросе на слияние">
</div>
<div class="title">Рисунок 92. Комментирование определённой строки в запросе на слияние</div>
</div>
<div class="paragraph">
<p>Как только владелец прокомментирует изменения, автор запроса на слияние (а также все подписавшиеся на этот репозиторий) получат уведомления.
Далее мы рассмотрим как настроить уведомления, но сейчас, если Тони включил уведомления через электронную почту, он получит следующее письмо:</p>
</div>
<div id="r_email_notification" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/blink-04-email.png" >}}" alt="Уведомление по электронной почте">
</div>
<div class="title">Рисунок 93. Комментарии, отправленные по электронной почте</div>
</div>
<div class="paragraph">
<p>Кто угодно может оставлять комментарии к запросу на слияние.
На <a href="{{< relurl "book/ru/v2/ch00/r_pr_discussion" >}}">Страница обсуждения запроса на слияние</a> можно увидеть пример, где владелец проекта оставил комментарии как к строке кода, так и в основной секции обсуждения.
Как вы могли заметить, комментарии к коду так же приведены в виде обсуждения.</p>
</div>
<div id="r_pr_discussion" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/blink-05-general-comment.png" >}}" alt="Страница обсуждения запроса на слияние">
</div>
<div class="title">Рисунок 94. Страница обсуждения запроса на слияние</div>
</div>
<div class="paragraph">
<p>Теперь участник может видеть что ему необходимо сделать для того, чтобы его изменения были приняты.
К счастью, это тоже легко сделать.
Используя почту, вам потребуется заново отправить свои изменения в список рассылки, а при использовании GitHub вы просто делаете коммит в тематическую ветку и повторяете push, что автоматически обновляет запрос на слияние.
На рисунке <a href="{{< relurl "book/ru/v2/ch00/r_pr_final" >}}">Финальная стадия запроса на слияние</a> также видно, что в обновлённом запросе на слияние старый комментарий к коду был свёрнут, так как он относится к строке, которая с тех пор изменилась.</p>
</div>
<div class="paragraph">
<p>Когда участник сделает это, владелец проекта снова получит уведомление, а на странице запроса будет отмечено, что проблема решена.
Фактически, как только строка кода имеющая комментарий будет изменена, GitHub заметит это и удалит устаревшее отличие.</p>
</div>
<div id="r_pr_final" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/blink-06-final.png" >}}" alt="Финальная стадия запроса на слияние">
</div>
<div class="title">Рисунок 95. Финальная стадия запроса на слияние</div>
</div>
<div class="paragraph">
<p>Примечательно, что если вы перейдёте на вкладку «Files Changed» в этом запросе на слияние, то увидите «унифицированную» разницу — это суммарные изменения, которые будут включены в основную ветку при слиянии тематической ветки.
В терминологии <code>git diff</code> это эквивалентно команде <code>git diff master…​&lt;branch&gt;</code> для ветки, на которой основан этот запрос на слияние.
В <a href="{{< relurl "book/ru/v2/ch00/r_what_is_introduced" >}}">Определение применяемых изменений</a> детальнее описан данный тип отличий.</p>
</div>
<div class="paragraph">
<p>GitHub так же проверяет может ли запрос на слияние быть применён без конфликтов и предоставляет кнопку для осуществления слияния на сервере.
Эта кнопка отображается только если у вас есть права на запись в репозиторий и возможно простейшее слияние.
По нажатию на неё GitHub произведёт «non-fast-forward» слияние, что значит даже если слияние <strong>может</strong> быть осуществлено перемоткой вперёд, всё равно будет создан коммит слияния.</p>
</div>
<div class="paragraph">
<p>При желании, можно стянуть ветку и произвести слияние локально.
Если эта ветка будет слита в <code>master</code> ветку и отправлена на сервер, то GitHub автоматически закроет запрос на слияние.</p>
</div>
<div class="paragraph">
<p>Это основной рабочий процесс, который используется большинством проектов на GitHub.
Создаются тематические ветки, открываются запросы на слияние, производится обсуждение, при необходимости производятся доработки в ветке и, наконец, запрос либо закрывается, либо сливается.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Примечание</div>
</td>
<td class="content">
<div class="title">Не только ответвления</div>
<div class="paragraph">
<p>Важно отметить, что можно открывать запросы на слияние между двумя ветками в одном репозитории.
Если вы работаете над функционалом с кем-то ещё и у вас обоих есть права записи, то вы можете отправить свою тематическую ветку в репозиторий и открыть запрос на слияние в <code>master</code> ветку в рамках одного проекта, что позволит инициировать процедуру проверки кода и его обсуждения.
Создание ответвлений проекта не является обязательным.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h3 id="_продвинутые_запросы_на_слияние">Продвинутые запросы на слияние</h3>
<div class="paragraph">
<p>На текущий момент мы рассмотрели основы участия в проекте на GitHub, давайте рассмотрим некоторые интересные секреты и уловки касательно запросов слияния, чтобы вы могли более эффективно их использовать.</p>
</div>
<div class="sect4">
<h4 id="_запросы_слияния_как_патчи">Запросы слияния как Патчи</h4>
<div class="paragraph">
<p>Важно понимать, что многие проекты не воспринимают запросы слияния как очередь идеальных патчей, которые должны применяться аккуратно и по порядку, как и большинство проектов, участие в которых основывается на отправке набора патчей через списки почтовых рассылок.
Большинство проектов на GitHub понимают ветки запросов на слияние как беседу относительно предлагаемого изменения, завершающуюся слиянием унифицированных изменений.</p>
</div>
<div class="paragraph">
<p>Это важное различие, так как изменение предлагается до того, как код станет считаться идеальным, что гораздо реже происходит с распространяемыми наборами патчей через списки рассылок.
Обсуждение происходит на более раннем этапе и выработка правильного решения происходит за счёт усилий сообщества.
Когда код предлагается через запрос на слияние и сопровождающий проекта или сообщество предлагает изменения, то не применяется набор патчей, а отправляются результирующие изменения как новый коммит в ветку, двигая обсуждение вперёд и сохраняя уже проделанную работу нетронутой.</p>
</div>
<div class="paragraph">
<p>Например, если вы вернётесь и посмотрите на <a href="{{< relurl "book/ru/v2/ch00/r_pr_final" >}}">Финальная стадия запроса на слияние</a>, то увидите, что участник не делал перебазирование своего коммита и не отправлял новый запрос на слияние.
Вместо этого были сделаны новые коммиты и отправлены в существующую ветку.
Таким образом, если вы в будущем вернётесь к этому запросу слияния, то легко найдёте весь контекст принятого решения.
По нажатию кнопки «Merge» целенаправленно создаётся коммит слияния, который указывает на запрос слияния, оставляя возможность возврата к цепочке обсуждения.</p>
</div>
</div>
<div class="sect4">
<h4 id="_следование_за_исходным_репозиторием">Следование за исходным репозиторием</h4>
<div class="paragraph">
<p>Если ваш запрос на слияние устарел или не может быть слит без конфликтов, то вам нужно изменить его, чтобы сопровождающий мог просто его слить.
GitHub проверит это за вас и под каждым из запросов на слияние отобразит уведомление, можно ли его слить без конфликтов или нет.</p>
</div>
<div id="r_pr_fail" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/pr-01-fail.png" >}}" alt="PR merge failure">
</div>
<div class="title">Рисунок 96. Запрос имеет конфликты слияния</div>
</div>
<div class="paragraph">
<p>Если вы видите что-то вроде <a href="{{< relurl "book/ru/v2/ch00/r_pr_fail" >}}">Запрос имеет конфликты слияния</a>, то вам следует изменить свою ветку так, чтобы исключить конфликты и сопровождающий не делал лишнюю работу.</p>
</div>
<div class="paragraph">
<p>Существует два основных варианта это сделать.
Вы можете либо перебазировать свою ветку относительно целевой ветки (обычно, относительно <code>master</code> ветки исходного репозитория), либо слить целевую ветку в свою.</p>
</div>
<div class="paragraph">
<p>Большинство разработчиков на GitHub выбирают последний вариант по тем же причинам, что и мы в предыдущем разделе.
Важна история и окончательное слияние, а перебазирование не принесёт вам ничего, кроме немного более чистой истории, при этом оно <strong>гораздо</strong> сложнее и может стать источником ошибок.</p>
</div>
<div class="paragraph">
<p>Если вы хотите сделать запрос на слияние применяемым, то следует добавить исходный репозиторий как новый удалённый, слить изменения из его основной ветки в вашу тематическую, если имеются исправить все проблемы и, наконец, отправить все изменения в ту ветку, на основании которой был открыт запрос на слияние.</p>
</div>
<div class="paragraph">
<p>Предположим, что в примере «tonychacon», который мы использовали ранее, основной автор сделал изменения, которые конфликтуют с запросом на слияние.
Рассмотрим это пошагово.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git remote add upstream https://github.com/schacon/blink <b class="conum">(1)</b>

$ git fetch upstream <b class="conum">(2)</b>
remote: Counting objects: 3, done.
remote: Compressing objects: 100% (3/3), done.
Unpacking objects: 100% (3/3), done.
remote: Total 3 (delta 0), reused 0 (delta 0)
From https://github.com/schacon/blink
 * [new branch]      master     -&gt; upstream/master

$ git merge upstream/master <b class="conum">(3)</b>
Auto-merging blink.ino
CONFLICT (content): Merge conflict in blink.ino
Automatic merge failed; fix conflicts and then commit the result.

$ vim blink.ino <b class="conum">(4)</b>
$ git add blink.ino
$ git commit
[slow-blink 3c8d735] Merge remote-tracking branch 'upstream/master' \
    into slower-blink

$ git push origin slow-blink <b class="conum">(5)</b>
Counting objects: 6, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (6/6), done.
Writing objects: 100% (6/6), 682 bytes | 0 bytes/s, done.
Total 6 (delta 2), reused 0 (delta 0)
To https://github.com/tonychacon/blink
   ef4725c..3c8d735  slower-blink -&gt; slow-blink</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Добавляем исходный репозиторий как удалённый с именем <code>upstream</code>.</p>
</li>
<li>
<p>Получаем последние изменения из него.</p>
</li>
<li>
<p>Сливаем основную ветку в нашу тематическую.</p>
</li>
<li>
<p>Исправляем указанный конфликт.</p>
</li>
<li>
<p>Отправляем изменения в ту же тематическую ветку.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Как только это будет сделано, запрос на слияние будет автоматически обновлён и перепроверен на возможность слияния.</p>
</div>
<div id="r_pr_merge_fix" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/pr-02-merge-fix.png" >}}" alt="PR fixed">
</div>
<div class="title">Рисунок 97. Запрос слияния без конфликтов</div>
</div>
<div class="paragraph">
<p>Одна из замечательных особенностей Git — это то, что вы можете делать это постоянно.
Если у вас очень длительный проект, вы можете легко сливать изменения из целевой ветки снова и снова и иметь дело только с конфликтами, возникшими с момента вашего последнего слияния, что делает процесс очень управляемым.</p>
</div>
<div class="paragraph">
<p>Если вы очень хотите перебазировать ветку, чтобы её почистить, то, конечно, вы можете это сделать, но настоятельно не рекомендуется переписывать ветку, к которой уже открыт запрос на слияние.
Если другие люди уже стянули её и проделали много работы, то вы столкнётесь со всеми проблемами, описанными в разделе <a href="{{< relurl "book/ru/v2/ch00/r_rebase_peril" >}}">Опасности перемещения</a> главы 3.
Вместо этого, отправьте перебазированную ветку в новую на GitHub и откройте новый запрос на слияние, который указывает на предыдущий, затем закройте исходный.</p>
</div>
</div>
<div class="sect4">
<h4 id="_ссылки">Ссылки</h4>
<div class="paragraph">
<p>Возможно, ваш следующий вопрос будет: «Как мне сослаться на предыдущий запрос слияния?»
Оказывается, существует много способов ссылаться на другие вещи практически везде, где у вас есть права записи на GitHub.</p>
</div>
<div class="paragraph">
<p>Давайте начнём с перекрёстных ссылок для запросов слияния или проблем.
Всем запросам слияния и проблемам присваиваются уникальные номера в пределах проекта.
Например, у вас не может быть запроса на слияние с номером #3 и проблемы с номером #3.
Если вы хотите сослаться на любой запрос слияния или проблему из другого места, просто добавьте <code>#&lt;num&gt;</code> в комментарий или описание.
Так же можно указывать более конкретно, если проблема или запрос слияния находятся где-то ещё; пишите <code>username#&lt;num&gt;</code> если ссылаетесь на проблему или запрос слияния, находящиеся в ответвлённом репозитории, или <code>username/repo#&lt;num&gt;</code> если ссылаетесь на другой репозиторий.</p>
</div>
<div class="paragraph">
<p>Рассмотрим это на примере.
Предположим, что мы перебазировали ветку в предыдущем примере, создали новый запрос слияния для неё и сейчас хотим сослаться на предыдущий запрос слияния из нового.
Так же мы хотим сослаться на проблему, находящуюся в ответвлённом репозитории, и на проблему из совершенно другого проекта.
Мы можем составить описание как указано на <a href="{{< relurl "book/ru/v2/ch00/r_pr_references" >}}">Перекрёстные ссылки в запросе слияния</a>.</p>
</div>
<div id="r_pr_references" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/mentions-01-syntax.png" >}}" alt="Перекрёстные ссылки в запросе слияния">
</div>
<div class="title">Рисунок 98. Перекрёстные ссылки в запросе слияния</div>
</div>
<div class="paragraph">
<p>Когда мы отправим запрос на слияние, то увидим что-то вроде <a href="{{< relurl "book/ru/v2/ch00/r_pr_references_render" >}}">Отображение перекрёстных ссылок в запросе слияния</a>.</p>
</div>
<div id="r_pr_references_render" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/mentions-02-render.png" >}}" alt="Отображение перекрёстных ссылок в запросе слияния">
</div>
<div class="title">Рисунок 99. Отображение перекрёстных ссылок в запросе слияния</div>
</div>
<div class="paragraph">
<p>Заметьте, что указанная полная ссылка на GitHub была сокращена до необходимого минимума.</p>
</div>
<div class="paragraph">
<p>Если Тони сейчас вернётся назад и закроет оригинальный запрос слияния, то мы это увидим, так как он упомянут в новом, а GitHub автоматически создаст отслеживающее событие в хронике запроса слияния.
Это значит, что все, кто просматривает закрытый запрос слияния, могут легко перейти к запросу слияния, который его заменил.
Ссылка будет выглядеть как указано на <a href="{{< relurl "book/ru/v2/ch00/r_pr_closed" >}}">Отображение перекрёстных ссылок в закрытом запросе слияния</a>.</p>
</div>
<div id="r_pr_closed" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/mentions-03-closed.png" >}}" alt="Отображение перекрёстных ссылок в закрытом запросе слияния">
</div>
<div class="title">Рисунок 100. Отображение перекрёстных ссылок в закрытом запросе слияния</div>
</div>
<div class="paragraph">
<p>Кроме идентификационных номеров, можно ссылаться на конкретный коммит используя SHA-1.
Следует указывать полный 40 символьный хеш SHA-1, но если GitHub увидит его в комментарии, то автоматически подставит ссылку на коммит.
Как было сказано выше, вы можете ссылаться на коммиты как в других, так и в ответвлённых репозиториях точно так же, как делали это с Проблемами.</p>
</div>
</div>
</div>
<div class="sect3">
<h3 id="_github_версия_разметки_markdown">GitHub-версия разметки Markdown</h3>
<div class="paragraph">
<p>Ссылки на другие Проблемы — это лишь часть интереснейших вещей, которые вы можете делать в текстовых полях на GitHub.
Для «проблемы» или «запроса слияния» в полях описания, комментария, комментария кода и других вы можете использовать так называемую «GitHub-версию разметки Markdown».
Разметка похожа на обычный текст, который основательно преобразуется.</p>
</div>
<div class="paragraph">
<p>Смотрите <a href="{{< relurl "book/ru/v2/ch00/r_example_markdown" >}}">Пример написания и отображения текста с разметкой</a> для примера как использовать разметку при написании комментариев и текста.</p>
</div>
<div id="r_example_markdown" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/markdown-01-example.png" >}}" alt="Пример разметки">
</div>
<div class="title">Рисунок 101. Пример написания и отображения текста с разметкой</div>
</div>
<div class="paragraph">
<p>GitHub расширил возможности обычной разметки.
Эти возможности могут быть очень полезными при создании запросов слияния или комментариев и описаний к проблемам.</p>
</div>
<div class="sect4">
<h4 id="_списки_задач">Списки задач</h4>
<div class="paragraph">
<p>Список задач — это первая действительно важная возможность специфической разметки GitHub, особенно для запросов слияния.
Список задач представляет собой список флажков для задач, которые вы хотите выполнить.
Размещение его в описании Проблемы или запроса на слияние обычно указывает на то, что должно быть сделано до того, как проблема будет считаться решённой.</p>
</div>
<div class="paragraph">
<p>Список задач можно добавить следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">- [X] Write the code
- [ ] Write all the tests
- [ ] Document the code</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если добавить этот список в описание запроса на слияние или проблемы, то он будет отображён следующим образом <a href="{{< relurl "book/ru/v2/ch00/r_task_lists" >}}">Отображение списка задач в комментарии</a></p>
</div>
<div id="r_task_lists" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/markdown-02-tasks.png" >}}" alt="Пример списка задач">
</div>
<div class="title">Рисунок 102. Отображение списка задач в комментарии</div>
</div>
<div class="paragraph">
<p>Он часто используется в запросах на слияние для отображения списка того, что вы хотите сделать до того, как запрос будет готов к слиянию.
Вы можете просто кликнуть по флажку, чтобы обновить комментарий — не нужно редактировать комментарий вручную, чтобы пометить задачу как выполненную.</p>
</div>
<div class="paragraph">
<p>Так же GitHub ищет списки задач в запросах на слияние и проблемах и отображает их как метаданные на страницах, где они упоминаются.
Например, если в вашем запросе на слияние есть задачи и вы просматриваете список всех запросов, то можно увидеть на сколько готов каждый из них.
Это позволяет разбивать запрос на слияние на несколько подзадач и помогает другим людям отслеживать прогресс ветки.
Пример приведён на <a href="{{< relurl "book/ru/v2/ch00/r_task_list_progress" >}}">Статистика задач в списке запросов слияния</a>.</p>
</div>
<div id="r_task_list_progress" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/markdown-03-task-summary.png" >}}" alt="Пример списка задач">
</div>
<div class="title">Рисунок 103. Статистика задач в списке запросов слияния</div>
</div>
<div class="paragraph">
<p>Такая возможность невероятно полезна когда вы открываете запрос на слияние на раннем этапе реализации и отслеживаете прогресс с помощью него.</p>
</div>
</div>
<div class="sect4">
<h4 id="_отрывки_кода">Отрывки кода</h4>
<div class="paragraph">
<p>В комментарии так же можно вставлять отрывки кода.
Это особенно полезно когда вы хотите показать что-нибудь, что вы <em>собираетесь</em> попробовать сделать, до того, как включить это в вашу ветку.
Так же часто применяется для добавления примеров кода, который не работает или мог быть добавлен в запрос на слияние.</p>
</div>
<div class="paragraph">
<p>Для добавления отрывка кода следует обрамить его обратными кавычками.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">```java
for(int i=0 ; i &lt; 5 ; i++)
{
   System.out.println("i is : " + i);
}
```</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если вы укажете название языка, как показано на примере, GitHub попробует применить к нему подсветку синтаксиса.
Для приведённого примера код будет выглядеть как на <a href="{{< relurl "book/ru/v2/ch00/r_md_code" >}}">Отображение обрамлённого кода</a>.</p>
</div>
<div id="r_md_code" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/markdown-04-fenced-code.png" >}}" alt="Отображение обрамлённого кода">
</div>
<div class="title">Рисунок 104. Отображение обрамлённого кода</div>
</div>
</div>
<div class="sect4">
<h4 id="_цитирование">Цитирование</h4>
<div class="paragraph">
<p>Если вы отвечаете только на часть большого комментария, то можно цитировать только выбранную часть, предваряя её символом <code>&gt;</code>.
Это настолько часто используется, что даже существует комбинация клавиш для этого.
Если в комментарии выделить текст, на который вы собираетесь ответить, и нажать клавишу <code>r</code>, то выделенный текст будет включён как цитата в ваш комментарий.</p>
</div>
<div class="paragraph">
<p>Цитаты выглядят примерно так:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">&gt; Whether 'tis Nobler in the mind to suffer
&gt; The Slings and Arrows of outrageous Fortune,

How big are these slings and in particular, these arrows?</code></pre>
</div>
</div>
<div class="paragraph">
<p>После обработки комментарий будет выглядеть как <a href="{{< relurl "book/ru/v2/ch00/r_md_quote" >}}">Пример отображения цитаты</a>.</p>
</div>
<div id="r_md_quote" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/markdown-05-quote.png" >}}" alt="Отображение цитаты">
</div>
<div class="title">Рисунок 105. Пример отображения цитаты</div>
</div>
</div>
<div class="sect4">
<h4 id="_смайлики">Смайлики</h4>
<div class="paragraph">
<p>Наконец, вы можете использовать смайлики.
На GitHub вы можете часто встретить их в комментариях или запросах на слияние.
Для них есть даже помощник.
Например, если при наборе комментария ввести символ двоеточия <code>:</code>, то будут предложены варианты автодополнения.</p>
</div>
<div id="r_md_emoji_auto" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/markdown-06-emoji-complete.png" >}}" alt="Помощник по смайлам">
</div>
<div class="title">Рисунок 106. Автодополнение для смайлов в действии</div>
</div>
<div class="paragraph">
<p>Смайлы имеют вид <code>:&lt;name&gt;:</code> и могут располагаться в любом месте комментария.
Например, вы можете написать что-нибудь вроде этого:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">I :eyes: that :bug: and I :cold_sweat:.

:trophy: for :microscope: it.

:+1: and :sparkles: on this :ship:, it's :fire::poop:!

:clap::tada::panda_face:</code></pre>
</div>
</div>
<div class="paragraph">
<p>Такой комментарий будет выглядеть как на <a href="{{< relurl "book/ru/v2/ch00/r_md_emoji" >}}">Перегруженный смайликами комментарий</a>.</p>
</div>
<div id="r_md_emoji" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/markdown-07-emoji.png" >}}" alt="Смайлики">
</div>
<div class="title">Рисунок 107. Перегруженный смайликами комментарий</div>
</div>
<div class="paragraph">
<p>Не то чтобы это невероятно полезно, но добавляет немного веселья и эмоций там, где трудно выразить какие-то эмоции.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Примечание</div>
</td>
<td class="content">
<div class="paragraph">
<p>На текущий момент существует много интернет сервисов, где используются смайлики.
Отличную шпаргалку по поиску смайликов, которые выражают нужную вам эмоцию, можно найти здесь:</p>
</div>
<div class="paragraph">
<p><a href="https://www.webfx.com/tools/emoji-cheat-sheet/" class="bare" target="_blank" rel="noopener">https://www.webfx.com/tools/emoji-cheat-sheet/</a></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h4 id="_картинки">Картинки</h4>
<div class="paragraph">
<p>Технически, картинки не относятся к разметке GitHub, но их использование очень полезно.
В дополнение к ссылкам на картинки в комментариях, GitHub позволяет встраивать картинки в комментарии.</p>
</div>
<div id="r_md_drag" class="imageblock">
<div class="content">
<img src="{{< relurl "book/ru/v2/images/markdown-08-drag-drop.png" >}}" alt="Перетаскивание картинки">
</div>
<div class="title">Рисунок 108. Перетаскивание картинки для загрузки и встраивания</div>
</div>
<div class="paragraph">
<p>Если вернуться немного назад к <a href="{{< relurl "book/ru/v2/ch00/r_pr_references" >}}">Перекрёстные ссылки в запросе слияния</a>, то над областью редактирования вы увидите небольшую подсказку «Parsed as Markdown».
Нажав не неё, вы получите полную подсказку по использованию GitHub разметки.</p>
</div>
</div>
</div>
<div class="sect3">
<h3 id="r_fetch_and_push_on_different_repositories">Поддержание GitHub репозитория в актуальном состоянии</h3>
<div class="paragraph">
<p>После создания форка, ваш репозиторий будет существовать независимо от оригинального репозитория.
В частности, при появлении в оригинальном репозитории новых коммитов GitHub информирует вас следующим сообщением:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">This branch is 5 commits behind progit:master.</code></pre>
</div>
</div>
<div class="paragraph">
<p>При этом GitHub никогда не обновляет ваш репозиторий — это вы должны делать сами.
К счастью, это очень просто сделать.</p>
</div>
<div class="paragraph">
<p>Первый способ не требует конфигурации.
Например, если вы сделали форк репозитория <code><a href="https://github.com/progit/progit2.git" class="bare">https://github.com/progit/progit2.git</a></code>, то актуализировать ветку <code>master</code> можно следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git checkout master <b class="conum">(1)</b>
$ git pull https://github.com/progit/progit2.git <b class="conum">(2)</b>
$ git push origin master <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Если вы находитесь на другой ветке — перейти на ветку <code>master</code>.</p>
</li>
<li>
<p>Получить изменения из репозитория <code><a href="https://github.com/progit/progit2.git" class="bare">https://github.com/progit/progit2.git</a></code> и слить их с веткой <code>master</code>.</p>
</li>
<li>
<p>Отправить локальную ветку <code>master</code> в ваш форк <code>origin</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Каждый раз писать URL репозитория для получения изменений достаточно утомительно.
Этот процесс можно автоматизировать слегка изменив настройки:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git remote add progit https://github.com/progit/progit2.git <b class="conum">(1)</b>
$ git fetch progit <b class="conum">(2)</b>
$ git branch --set-upstream-to=progit/master master <b class="conum">(3)</b>
$ git config --local remote.pushDefault origin <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Добавить исходный репозиторий как удалённый и назвать его <code>progit</code>.</p>
</li>
<li>
<p>Получить ветки репозитория <code>progit</code>, в частности ветку <code>master</code>.</p>
</li>
<li>
<p>Настроить локальную ветку <code>master</code> на получение изменений из репозитория <code>progit</code>.</p>
</li>
<li>
<p>Установить <code>origin</code> как репозиторий по умолчанию для отправки.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>После этого, процесс обновления становится гораздо проще:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git checkout master <b class="conum">(1)</b>
$ git pull <b class="conum">(2)</b>
$ git push <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Если вы находитесь на другой ветке — перейти на ветку <code>master</code>.</p>
</li>
<li>
<p>Получить изменения из репозитория <code>progit</code> и слить их с веткой <code>master</code>.</p>
</li>
<li>
<p>Отправить локальную ветку <code>master</code> в ваш форк <code>origin</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Данный подход не лишён недостатков.
Git будет молча выполнять указанные действия и не предупредит вас в случае, когда вы добавили коммит в <code>master</code>, получили изменения из <code>progit</code> и отправили всё вместе в <code>origin</code> — все эти операции абсолютно корректны.
Поэтому вам стоит исключить прямое добавление коммитов в ветку <code>master</code>, поскольку эта ветка фактически принадлежит другому репозиторию.</p>
</div>
</div>
<div id="nav"><a href="{{< previous-section >}}">prev</a> | <a href="{{< next-section >}}">next</a></div>