---
### DO NOT EDIT! Generated by script/update-book2.rb
category: book
section: documentation
subsection: book
sidebar: book
book:
  language_code: zh
  chapter:
    title: 服务器上的 Git
    number: 4
  section:
    title: 生成 SSH 公钥
    number: 3
    cs_number: '4.3'
    previous: book/zh/v2/服务器上的-Git-在服务器上搭建-Git
    next: book/zh/v2/服务器上的-Git-配置服务器
title: Git - 生成 SSH 公钥
url: "/book/zh/v2/服务器上的-Git-生成-SSH-公钥.html"
---
<h2 id="_generate_ssh_key">生成 SSH 公钥</h2>
<div class="paragraph">
<p>
如前所述，许多 Git 服务器都使用 SSH 公钥进行认证。
为了向 Git 服务器提供 SSH 公钥，如果某系统用户尚未拥有密钥，必须事先为其生成一份。
这个过程在所有操作系统上都是相似的。
首先，你需要确认自己是否已经拥有密钥。
默认情况下，用户的 SSH 密钥存储在其 <code>~/.ssh</code> 目录下。
进入该目录并列出其中内容，你便可以快速确认自己是否已拥有密钥：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cd ~/.ssh
$ ls
authorized_keys2  id_dsa       known_hosts
config            id_dsa.pub</code></pre>
</div>
</div>
<div class="paragraph">
<p>我们需要寻找一对以 <code>id_dsa</code> 或 <code>id_rsa</code> 命名的文件，其中一个带有 <code>.pub</code> 扩展名。
<code>.pub</code> 文件是你的公钥，另一个则是与之对应的私钥。
如果找不到这样的文件（或者根本没有 <code>.ssh</code> 目录），你可以通过运行 <code>ssh-keygen</code> 程序来创建它们。
在 Linux/macOS 系统中，<code>ssh-keygen</code> 随 SSH 软件包提供；在 Windows 上，该程序包含于 MSysGit 软件包中。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ssh-keygen -o
Generating public/private rsa key pair.
Enter file in which to save the key (/home/schacon/.ssh/id_rsa):
Created directory '/home/schacon/.ssh'.
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/schacon/.ssh/id_rsa.
Your public key has been saved in /home/schacon/.ssh/id_rsa.pub.
The key fingerprint is:
d0:82:24:8e:d7:f1:bb:9b:33:53:96:93:49:da:9b:e3 schacon@mylaptop.local</code></pre>
</div>
</div>
<div class="paragraph">
<p>首先 <code>ssh-keygen</code> 会确认密钥的存储位置（默认是 <code>.ssh/id_rsa</code>），然后它会要求你输入两次密钥口令。
如果你不想在使用密钥时输入口令，将其留空即可。
然而，如果你使用了密码，那么请确保添加了 <code>-o</code> 选项，它会以比默认格式更能抗暴力破解的格式保存私钥。
你也可以用 <code>ssh-agent</code> 工具来避免每次都要输入密码。</p>
</div>
<div class="paragraph">
<p>现在，进行了上述操作的用户需要将各自的公钥发送给任意一个 Git 服务器管理员
（假设服务器正在使用基于公钥的 SSH 验证设置）。
他们所要做的就是复制各自的 <code>.pub</code> 文件内容，并将其通过邮件发送。
公钥看起来是这样的：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cat ~/.ssh/id_rsa.pub
ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAklOUpkDHrfHY17SbrmTIpNLTGK9Tjom/BWDSU
GPl+nafzlHDTYW7hdI4yZ5ew18JH4JW9jbhUFrviQzM7xlELEVf4h9lFX5QVkbPppSwg0cda3
Pbv7kOdJ/MTyBlWXFCR+HAo3FXRitBqxiX1nKhXpHAZsMciLq8V6RjsNAQwdsdMFvSlVK/7XA
t3FaoJoAsncM1Q9x5+3V0Ww68/eIFmb1zuUFljQJKprrX88XypNDvjYNby6vw/Pb0rwert/En
mZ+AW4OZPnTPI89ZPmVMLuayrD2cE86Z/il8b+gw3r3+1nKatmIkjn2so1d01QraTlMqVSsbx
NrRFi9wrf+M7Q== schacon@mylaptop.local</code></pre>
</div>
</div>
<div class="paragraph">
<p>关于在多种操作系统中生成 SSH 密钥的更深入教程，请参阅 GitHub 的 SSH 密钥指南
<a href="https://docs.github.com/cn/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent" class="bare">https://docs.github.com/cn/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent</a>。</p>
</div>
<div id="nav"><a href="{{< previous-section >}}">prev</a> | <a href="{{< next-section >}}">next</a></div>