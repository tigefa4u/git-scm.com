---
### DO NOT EDIT! Generated by script/update-docs.rb

category: manual
section: documentation
subsection: manual
title: Git - api-merge Documentation
docname: api-merge
version: 2.0.5
aliases:
- "/docs/api-merge/2.0.5/index.html"
- "/docs/api-merge/2.1.4/index.html"
- "/docs/api-merge/2.2.3/index.html"
- "/docs/api-merge/2.3.10/index.html"
- "/docs/api-merge/2.4.12/index.html"
- "/docs/api-merge/2.5.6/index.html"
- "/docs/api-merge/2.6.7/index.html"
- "/docs/api-merge/2.7.6/index.html"
- "/docs/api-merge/2.8.6/index.html"
- "/docs/api-merge/2.9.5/index.html"
- "/docs/api-merge/2.10.5/index.html"
- "/docs/api-merge/2.11.4/index.html"
- "/docs/api-merge/2.12.5/index.html"
- "/docs/api-merge/2.13.7/index.html"
- "/docs/api-merge/2.14.6/index.html"
- "/docs/api-merge/2.15.4/index.html"
- "/docs/api-merge/2.16.6/index.html"
- "/docs/api-merge/2.17.0/index.html"
- "/docs/api-merge/2.17.1/index.html"
- "/docs/api-merge/2.17.2/index.html"
- "/docs/api-merge/2.17.3/index.html"
- "/docs/api-merge/2.17.4/index.html"
- "/docs/api-merge/2.17.5/index.html"
- "/docs/api-merge/2.17.6/index.html"
- "/docs/api-merge/2.18.0/index.html"
- "/docs/api-merge/2.18.1/index.html"
- "/docs/api-merge/2.18.2/index.html"
- "/docs/api-merge/2.18.3/index.html"
- "/docs/api-merge/2.18.4/index.html"
- "/docs/api-merge/2.18.5/index.html"
- "/docs/api-merge/2.19.0/index.html"
- "/docs/api-merge/2.19.1/index.html"
- "/docs/api-merge/2.19.2/index.html"
- "/docs/api-merge/2.19.3/index.html"
- "/docs/api-merge/2.19.4/index.html"
- "/docs/api-merge/2.19.5/index.html"
- "/docs/api-merge/2.19.6/index.html"
- "/docs/api-merge/2.20.0/index.html"
- "/docs/api-merge/2.20.1/index.html"
- "/docs/api-merge/2.20.2/index.html"
- "/docs/api-merge/2.20.3/index.html"
- "/docs/api-merge/2.20.4/index.html"
- "/docs/api-merge/2.20.5/index.html"
- "/docs/api-merge/2.21.0/index.html"
- "/docs/api-merge/2.21.1/index.html"
- "/docs/api-merge/2.21.2/index.html"
- "/docs/api-merge/2.21.3/index.html"
- "/docs/api-merge/2.21.4/index.html"
- "/docs/api-merge/2.22.0/index.html"
- "/docs/api-merge/2.22.1/index.html"
- "/docs/api-merge/2.22.2/index.html"
- "/docs/api-merge/2.22.3/index.html"
- "/docs/api-merge/2.22.4/index.html"
- "/docs/api-merge/2.22.5/index.html"
- "/docs/api-merge/2.23.0/index.html"
- "/docs/api-merge/2.23.1/index.html"
- "/docs/api-merge/2.23.2/index.html"
- "/docs/api-merge/2.23.3/index.html"
- "/docs/api-merge/2.23.4/index.html"
- "/docs/api-merge/2.24.0/index.html"
- "/docs/api-merge/2.24.1/index.html"
- "/docs/api-merge/2.24.2/index.html"
- "/docs/api-merge/2.24.3/index.html"
- "/docs/api-merge/2.24.4/index.html"
---
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The merge API helps a program to reconcile two competing sets of
improvements to some files (e.g., unregistered changes from the work
tree versus changes involved in switching to a new branch), reporting
conflicts if found.  The library called through this API is
responsible for a few things.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>determining which trees to merge (recursive ancestor consolidation);</p>
</li>
<li>
<p>lining up corresponding files in the trees to be merged (rename
detection, subtree shifting), reporting edge cases like add/add
and rename/rename conflicts to the user;</p>
</li>
<li>
<p>performing a three-way merge of corresponding files, taking
path-specific merge drivers (specified in <code>.gitattributes</code>)
into account.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_structures"><a class="anchor" href="#_data_structures"></a>Data structures</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>mmbuffer_t</code>, <code>mmfile_t</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These store data usable for use by the xdiff backend, for writing and
for reading, respectively.  See <code>xdiff/xdiff.h</code> for the definitions
and <code>diff.c</code> for examples.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>struct ll_merge_options</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This describes the set of options the calling program wants to affect
the operation of a low-level (single file) merge.  Some options:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-merge.txt-codevirtualancestorcode"> <a class="anchor" href="#Documentation/technical/api-merge.txt-codevirtualancestorcode"></a><code>virtual_ancestor</code> </dt>
<dd>
<p>Behave as though this were part of a merge between common
ancestors in a recursive merge.
If a helper program is specified by the
<code>[merge "&lt;driver&gt;"] recursive</code> configuration, it will
be used (see <a href='{{< relurl "docs/gitattributes" >}}'>gitattributes[5]</a>).</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-merge.txt-codevariantcode"> <a class="anchor" href="#Documentation/technical/api-merge.txt-codevariantcode"></a><code>variant</code> </dt>
<dd>
<p>Resolve local conflicts automatically in favor
of one side or the other (as in <em>git merge-file</em>
<code>--ours</code>/<code>--theirs</code>/<code>--union</code>).  Can be <code>0</code>,
<code>XDL_MERGE_FAVOR_OURS</code>, <code>XDL_MERGE_FAVOR_THEIRS</code>, or
<code>XDL_MERGE_FAVOR_UNION</code>.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-merge.txt-coderenormalizecode"> <a class="anchor" href="#Documentation/technical/api-merge.txt-coderenormalizecode"></a><code>renormalize</code> </dt>
<dd>
<p>Resmudge and clean the "base", "theirs" and "ours" files
before merging.  Use this when the merge is likely to have
overlapped with a change in smudge/clean or end-of-line
normalization rules.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_low_level_single_file_merge"><a class="anchor" href="#_low_level_single_file_merge"></a>Low-level (single file) merge</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-merge.txt-codellmergecode"> <a class="anchor" href="#Documentation/technical/api-merge.txt-codellmergecode"></a><code>ll_merge</code> </dt>
<dd>
<p>Perform a three-way single-file merge in core.  This is
a thin wrapper around <code>xdl_merge</code> that takes the path and
any merge backend specified in <code>.gitattributes</code> or
<code>.git/info/attributes</code> into account.  Returns 0 for a
clean merge.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Calling sequence:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prepare a <code>struct ll_merge_options</code> to record options.
If you have no special requests, skip this and pass <code>NULL</code>
as the <code>opts</code> parameter to use the default options.</p>
</li>
<li>
<p>Allocate an mmbuffer_t variable for the result.</p>
</li>
<li>
<p>Allocate and fill variables with the file&#8217;s original content
and two modified versions (using <code>read_mmfile</code>, for example).</p>
</li>
<li>
<p>Call <code>ll_merge()</code>.</p>
</li>
<li>
<p>Read the merged content from <code>result_buf.ptr</code> and <code>result_buf.size</code>.</p>
</li>
<li>
<p>Release buffers when finished.  A simple
<code>free(ancestor.ptr); free(ours.ptr); free(theirs.ptr);
free(result_buf.ptr);</code> will do.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the modifications do not merge cleanly, <code>ll_merge</code> will return a
nonzero value and <code>result_buf</code> will generally include a description of
the conflict bracketed by markers such as the traditional <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code>
and <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code>.</p>
</div>
<div class="paragraph">
<p>The <code>ancestor_label</code>, <code>our_label</code>, and <code>their_label</code> parameters are
used to label the different sides of a conflict if the merge driver
supports this.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_everything_else"><a class="anchor" href="#_everything_else"></a>Everything else</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Talk about &lt;merge-recursive.h&gt; and merge_file():</p>
</div>
<div class="ulist">
<ul>
<li>
<p>merge_trees() to merge with rename detection</p>
</li>
<li>
<p>merge_recursive() for ancestor consolidation</p>
</li>
<li>
<p>try_merge_command() for other strategies</p>
</li>
<li>
<p>conflict format</p>
</li>
<li>
<p>merge options</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>(Daniel, Miklos, Stephan, JC)</p>
</div>
</div>
</div>