---
### DO NOT EDIT! Generated by script/update-docs.rb

category: manual
section: documentation
subsection: manual
title: Git - git-shell Documentation
docname: git-shell
lang: zh_HANS-CN
aliases:
- "/docs/git-shell/zh_HANS-CN/index.html"
---
<div class="sect1">
<h2 id="_名称"><a class="anchor" href="#_名称"></a>名称</h2>
<div class="sectionbody">
<div class="paragraph">
<p>git-shell - 仅限 Git SSH 访问的受限登录 shell</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_概述"><a class="anchor" href="#_概述"></a>概述</h2>
<div class="sectionbody">
<div class="verseblock">
<pre class="content"><em>chsh</em> -s $(command -v git-shell) &lt;用户&gt;
<em>git clone</em> &lt;用户&gt;<code>@localhost:/path/to/repo.git</code>
<em>ssh</em> &lt;用户&gt;<code>@localhost</code></pre>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_描述"><a class="anchor" href="#_描述"></a>描述</h2>
<div class="sectionbody">
<div class="paragraph">
<p>这是 SSH 账户的登录 shell，提供受限的 Git 访问权限。 它只允许执行实现拉/推功能的服务器端 Git 命令，以及用户主目录中名为 <code>git-shell-commands</code> 子目录下的自定义命令。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_命令"><a class="anchor" href="#_命令"></a>命令</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>git shell</em> 接受在 <code>-c</code> 选项之后的下列命令：</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1" id="git-shell-emgitreceive-packltgtem"> <a class="anchor" href="#git-shell-emgitreceive-packltgtem"></a><em>git receive-pack &lt;参数&gt;</em> </dt>
<dt class="hdlist1" id="git-shell-emgitupload-packltgtem"> <a class="anchor" href="#git-shell-emgitupload-packltgtem"></a><em>git upload-pack &lt;参数&gt;</em> </dt>
<dt class="hdlist1" id="git-shell-emgitupload-archiveltgtem"> <a class="anchor" href="#git-shell-emgitupload-archiveltgtem"></a><em>git upload-archive &lt;参数&gt;</em> </dt>
<dd>
<p>调用相应的服务器端命令，以支持客户端的 <em>git push</em>、<em>git fetch</em> 或 <em>git archive --remote</em> 请求。</p>
</dd>
<dt class="hdlist1" id="git-shell-cvs"> <a class="anchor" href="#git-shell-cvs"></a>‘cvs 服务器’ </dt>
<dd>
<p>模仿 CVS 服务器。 参见 <a href='{{< relurl "docs/git-cvsserver/zh_HANS-CN" >}}'>git-cvsserver[1]</a>。</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>如果有 <code>~/git-shell-commands</code> 目录，<em>git shell</em> 也会处理其他自定义命令，方法是从用户的主目录运行 "<code>git-shell-commands/&lt;命令&gt; &lt;参数&gt;</code>"。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_交互式使用"><a class="anchor" href="#_交互式使用"></a>交互式使用</h2>
<div class="sectionbody">
<div class="paragraph">
<p>默认情况下，上述命令只能通过 <code>-c</code> 选项执行；shell 不是交互式的。</p>
</div>
<div class="paragraph">
<p>如果有 <code>~/git-shell-commands</code> 目录，<em>git shell</em> 也可以交互式运行（不带参数）。 如果 <code>git-shell-commands</code> 目录中有 <code>help</code> 命令，则会运行该命令向用户提供允许操作的概览。 然后会出现 "git&gt;" 提示，用户可以在此输入`git-shell-commands`目录下的任何命令，或`exit`关闭连接。</p>
</div>
<div class="paragraph">
<p>一般情况下，该模式用作管理界面，允许用户列出他们可以访问的资源库，创建、删除或重命名资源库，或更改资源库说明和权限。</p>
</div>
<div class="paragraph">
<p>如果存在 <code>no-interactive-login</code> 命令，则运行该命令并终止交互式 shell。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_实例"><a class="anchor" href="#_实例"></a>实例</h2>
<div class="sectionbody">
<div class="paragraph">
<p>禁用交互式登录，显示问候语：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ chsh -s /usr/bin/git-shell
$ mkdir $HOME/git-shell-commands
$ cat &gt;$HOME/git-shell-commands/no-interactive-login &lt;&lt;\EOF
#!/bin/sh
printf '%s\n' "你好，$USER！您已成功通过身份验证，但我没有"
printf '%s\n' "提供交互式 shell 访问。"
exit 128
EOF
$ chmod +x $HOME/git-shell-commands/no-interactive-login</pre>
</div>
</div>
<div class="paragraph">
<p>要启用 git-cvsserver 访问权限（一般应以上面的 <code>no-interactive-login</code> 示例为前提，因为创建 git-shell-commands 目录允许交互式登录）：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cat &gt;$HOME/git-shell-commands/cvs &lt;&lt;\EOF
if ! test $# = 1 &amp;&amp; test "$1" = "server"
then
	echo &gt;&amp;2 "git-cvsserver only handles \"server\""
	exit 1
fi
exec git cvsserver server
EOF
$ chmod +x $HOME/git-shell-commands/cvs</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_参见"><a class="anchor" href="#_参见"></a>参见</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ssh(1), <a href='{{< relurl "docs/git-daemon/zh_HANS-CN" >}}'>git-daemon[1]</a>, contrib/git-shell-commands/README</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_git"><a class="anchor" href="#_git"></a>GIT</h2>
<div class="sectionbody">
<div class="paragraph">
<p>属于 <a href='{{< relurl "docs/git/zh_HANS-CN" >}}'>git[1]</a> 文档</p>
</div>
</div>
</div>