---
### DO NOT EDIT! Generated by script/update-docs.rb

category: manual
section: documentation
subsection: manual
title: Git - api-tree-walking Documentation
docname: api-tree-walking
version: 2.0.5
aliases:
- "/docs/api-tree-walking/2.0.5/index.html"
- "/docs/api-tree-walking/2.1.4/index.html"
- "/docs/api-tree-walking/2.2.3/index.html"
- "/docs/api-tree-walking/2.3.10/index.html"
- "/docs/api-tree-walking/2.4.12/index.html"
- "/docs/api-tree-walking/2.5.6/index.html"
- "/docs/api-tree-walking/2.6.7/index.html"
- "/docs/api-tree-walking/2.7.6/index.html"
- "/docs/api-tree-walking/2.8.6/index.html"
- "/docs/api-tree-walking/2.9.5/index.html"
- "/docs/api-tree-walking/2.10.5/index.html"
- "/docs/api-tree-walking/2.11.4/index.html"
- "/docs/api-tree-walking/2.12.5/index.html"
- "/docs/api-tree-walking/2.13.7/index.html"
- "/docs/api-tree-walking/2.14.6/index.html"
---
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The tree walking API is used to traverse and inspect trees.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_structures"><a class="anchor" href="#_data_structures"></a>Data Structures</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codestructnameentrycode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codestructnameentrycode"></a><code>struct name_entry</code> </dt>
<dd>
<p>An entry in a tree. Each entry has a sha1 identifier, pathname, and
mode.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codestructtreedesccode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codestructtreedesccode"></a><code>struct tree_desc</code> </dt>
<dd>
<p>A semi-opaque data structure used to maintain the current state of the
walk.</p>
<div class="ulist">
<ul>
<li>
<p><code>buffer</code> is a pointer into the memory representation of the tree. It always
points at the current entry being visited.</p>
</li>
<li>
<p><code>size</code> counts the number of bytes left in the <code>buffer</code>.</p>
</li>
<li>
<p><code>entry</code> points to the current entry being visited.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codestructtraverseinfocode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codestructtraverseinfocode"></a><code>struct traverse_info</code> </dt>
<dd>
<p>A structure used to maintain the state of a traversal.</p>
<div class="ulist">
<ul>
<li>
<p><code>prev</code> points to the traverse_info which was used to descend into the
current tree. If this is the top-level tree <code>prev</code> will point to
a dummy traverse_info.</p>
</li>
<li>
<p><code>name</code> is the entry for the current tree (if the tree is a subtree).</p>
</li>
<li>
<p><code>pathlen</code> is the length of the full path for the current tree.</p>
</li>
<li>
<p><code>conflicts</code> can be used by callbacks to maintain directory-file conflicts.</p>
</li>
<li>
<p><code>fn</code> is a callback called for each entry in the tree. See Traversing for more
information.</p>
</li>
<li>
<p><code>data</code> can be anything the <code>fn</code> callback would want to use.</p>
</li>
<li>
<p><code>show_all_errors</code> tells whether to stop at the first error or not.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_initializing"><a class="anchor" href="#_initializing"></a>Initializing</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codeinittreedesccode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codeinittreedesccode"></a><code>init_tree_desc</code> </dt>
<dd>
<p>Initialize a <code>tree_desc</code> and decode its first entry. The buffer and
size parameters are assumed to be the same as the buffer and size
members of <code>struct tree</code>.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codefilltreedescriptorcode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codefilltreedescriptorcode"></a><code>fill_tree_descriptor</code> </dt>
<dd>
<p>Initialize a <code>tree_desc</code> and decode its first entry given the sha1 of
a tree. Returns the <code>buffer</code> member if the sha1 is a valid tree
identifier and NULL otherwise.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codesetuptraverseinfocode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codesetuptraverseinfocode"></a><code>setup_traverse_info</code> </dt>
<dd>
<p>Initialize a <code>traverse_info</code> given the pathname of the tree to start
traversing from. The <code>base</code> argument is assumed to be the <code>path</code>
member of the <code>name_entry</code> being recursed into unless the tree is a
top-level tree in which case the empty string ("") is used.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_walking"><a class="anchor" href="#_walking"></a>Walking</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codetreeentrycode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codetreeentrycode"></a><code>tree_entry</code> </dt>
<dd>
<p>Visit the next entry in a tree. Returns 1 when there are more entries
left to visit and 0 when all entries have been visited. This is
commonly used in the test of a while loop.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codetreeentrylencode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codetreeentrylencode"></a><code>tree_entry_len</code> </dt>
<dd>
<p>Calculate the length of a tree entry&#8217;s pathname. This utilizes the
memory structure of a tree entry to avoid the overhead of using a
generic strlen().</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codeupdatetreeentrycode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codeupdatetreeentrycode"></a><code>update_tree_entry</code> </dt>
<dd>
<p>Walk to the next entry in a tree. This is commonly used in conjunction
with <code>tree_entry_extract</code> to inspect the current entry.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codetreeentryextractcode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codetreeentryextractcode"></a><code>tree_entry_extract</code> </dt>
<dd>
<p>Decode the entry currently being visited (the one pointed to by
<code>tree_desc's</code> <code>entry</code> member) and return the sha1 of the entry. The
<code>pathp</code> and <code>modep</code> arguments are set to the entry&#8217;s pathname and mode
respectively.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codegettreeentrycode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codegettreeentrycode"></a><code>get_tree_entry</code> </dt>
<dd>
<p>Find an entry in a tree given a pathname and the sha1 of a tree to
search. Returns 0 if the entry is found and -1 otherwise. The third
and fourth parameters are set to the entry&#8217;s sha1 and mode
respectively.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_traversing"><a class="anchor" href="#_traversing"></a>Traversing</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codetraversetreescode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codetraversetreescode"></a><code>traverse_trees</code> </dt>
<dd>
<p>Traverse <code>n</code> number of trees in parallel. The <code>fn</code> callback member of
<code>traverse_info</code> is called once for each tree entry.</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codetraversecallbacktcode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codetraversecallbacktcode"></a><code>traverse_callback_t</code> </dt>
<dd>
<p>The arguments passed to the traverse callback are as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>n</code> counts the number of trees being traversed.</p>
</li>
<li>
<p><code>mask</code> has its nth bit set if something exists in the nth entry.</p>
</li>
<li>
<p><code>dirmask</code> has its nth bit set if the nth tree&#8217;s entry is a directory.</p>
</li>
<li>
<p><code>entry</code> is an array of size <code>n</code> where the nth entry is from the nth tree.</p>
</li>
<li>
<p><code>info</code> maintains the state of the traversal.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Returning a negative value will terminate the traversal. Otherwise the
return value is treated as an update mask. If the nth bit is set the nth tree
will be updated and if the bit is not set the nth tree entry will be the
same in the next callback invocation.</p>
</div>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codemaketraversepathcode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codemaketraversepathcode"></a><code>make_traverse_path</code> </dt>
<dd>
<p>Generate the full pathname of a tree entry based from the root of the
traversal. For example, if the traversal has recursed into another
tree named "bar" the pathname of an entry "baz" in the "bar"
tree would be "bar/baz".</p>
</dd>
<dt class="hdlist1" id="Documentation/technical/api-tree-walking.txt-codetraversepathlencode"> <a class="anchor" href="#Documentation/technical/api-tree-walking.txt-codetraversepathlencode"></a><code>traverse_path_len</code> </dt>
<dd>
<p>Calculate the length of a pathname returned by <code>make_traverse_path</code>.
This utilizes the memory structure of a tree entry to avoid the
overhead of using a generic strlen().</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authors"><a class="anchor" href="#_authors"></a>Authors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Written by Junio C Hamano &lt;<a href="mailto:gitster@pobox.com">gitster@pobox.com</a>&gt; and Linus Torvalds
&lt;<a href="mailto:torvalds@linux-foundation.org">torvalds@linux-foundation.org</a>&gt;</p>
</div>
</div>
</div>